No local changes to save
Fetching origin
Already on 'kitchen-experiment-hacking'
Your branch is up to date with 'origin/kitchen-experiment-hacking'.
Already up to date.
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_diverse --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only False --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 0
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7f34d9f4ee60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_diverse', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=False, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7f34d9f4eef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=0, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
cold
holding
inactive
not_at
positioned
unoccupied
released
placed
removed_from
placed_on
located
turned
engaged
grasping
free
active
hot
on
letting_go
positioned_on
off
gripping
not_turned
not_on
empty
releasing
disengaged
deactivated
occupied
clutching
at
rotated
turned_off
removed
activated
turned_on
not_gripping
VLM proposed a total of 137 atoms.
Of these, 84 were valid and unique.
For the 37 predicates, there were 160 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.261) 2.0
Forall[0:kettle].[((0:kettle).x<=[idx 0]-0.261)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).x<=[idx 0]-0.261)(0)] 3.0
NOT-((0:kettle).x<=[idx 0]-0.261) 2.0
((0:kettle).y<=[idx 0]0.501) 2.0
Forall[0:kettle].[((0:kettle).y<=[idx 0]0.501)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 0]0.501)(0)] 3.0
NOT-((0:kettle).y<=[idx 0]0.501) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.326) 2.0
NOT-((0:knob).angle<=[idx 0]-0.326) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:kettle).x<=[idx 1]-0.265) 3.0
NOT-((0:kettle).x<=[idx 1]-0.265) 3.0
((0:kettle).y<=[idx 1]0.451) 3.0
Forall[0:kettle].[((0:kettle).y<=[idx 1]0.451)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 1]0.451)(0)] 4.0
NOT-((0:kettle).y<=[idx 1]0.451) 3.0
((0:knob).angle<=[idx 1]-0.489) 3.0
NOT-((0:knob).angle<=[idx 1]-0.489) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:gripper).y<=[idx 3]0.541) 4.0
Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-((0:gripper).y<=[idx 3]0.541) 4.0
((0:knob).angle<=[idx 3]-0.57) 4.0
NOT-((0:knob).angle<=[idx 3]-0.57) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:gripper).x<=[idx 11]-0.245) 5.0
Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-((0:gripper).x<=[idx 11]-0.245) 5.0
((0:gripper).qw<=[idx 11]0.103) 5.0
Forall[0:gripper].[((0:gripper).qw<=[idx 11]0.103)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 11]0.103)(0)] 6.0
NOT-((0:gripper).qw<=[idx 11]0.103) 5.0
((0:gripper).x<=[idx 19]-0.254) 6.0
Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-((0:gripper).x<=[idx 19]-0.254) 6.0
((0:gripper).z<=[idx 31]1.92) 7.0
Forall[0:gripper].[((0:gripper).z<=[idx 31]1.92)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 31]1.92)(0)] 8.0
NOT-((0:gripper).z<=[idx 31]1.92) 7.0
((0:gripper).qx<=[idx 31]-0.704) 7.0
NOT-((0:gripper).qx<=[idx 31]-0.704) 7.0
((0:gripper).z<=[idx 63]1.91) 8.0
Forall[0:gripper].[((0:gripper).z<=[idx 63]1.91)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 63]1.91)(0)] 9.0
NOT-((0:gripper).z<=[idx 63]1.91) 8.0
((0:gripper).qx<=[idx 63]-0.713) 8.0
NOT-((0:gripper).qx<=[idx 63]-0.713) 8.0
((0:gripper).y<=[idx 67]0.542) 8.0
Forall[0:gripper].[((0:gripper).y<=[idx 67]0.542)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 67]0.542)(0)] 9.0
NOT-((0:gripper).y<=[idx 67]0.542) 8.0
((0:knob).angle<=[idx 91]-0.504) 8.0
NOT-((0:knob).angle<=[idx 91]-0.504) 8.0
((0:surface).z<=[idx 98]1.6) 8.0
NOT-((0:surface).z<=[idx 98]1.6) 8.0
((0:knob).angle<=[idx 127]-0.649) 9.0
NOT-((0:knob).angle<=[idx 127]-0.649) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3098.9695203048004 computed in 0.055 seconds


Starting hill climbing at state frozenset() with heuristic 3098.9695203048004
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3062.970180303601 computed in 0.041 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]]}), with total cost 6.0
	Total score: 3098.969640315599 computed in 0.045 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 63.03054000239985 computed in 0.047 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 123.0305999999999 computed in 0.057 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 123.03069999999988 computed in 0.058 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 123.03049999999989 computed in 0.172 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]]}), with total cost 9.0
	Total score: 123.03089999999989 computed in 0.054 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.071 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]]}), with total cost 8.0
	Total score: 3110.9697203143996 computed in 0.037 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]]}), with total cost 9.0
	Total score: 3110.9698203144 computed in 0.037 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.163 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]]}), with total cost 3.0
	Total score: 3110.9692203144 computed in 0.062 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]]}), with total cost 3.0
	Total score: 3106.9694203112 computed in 0.094 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]]}), with total cost 4.0
	Total score: 3102.9697203079995 computed in 0.092 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3110.9692203144 computed in 0.062 seconds
Evaluating predicates: frozenset({KettleBoiling}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.206 seconds
Evaluating predicates: frozenset({KnobAndBurnerLinked}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.081 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 63.03054000239985 computed in 0.080 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]]}), with total cost 6.0
	Total score: 123.0305999999999 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3062.970180303601 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 3098.969640315599 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 3098.969740315599 computed in 0.180 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 3098.9695403155993 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]]}), with total cost 9.0
	Total score: 3098.969940315599 computed in 0.049 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3098.9695803096006 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]]}), with total cost 8.0
	Total score: 3074.9704403072 computed in 0.080 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]]}), with total cost 9.0
	Total score: 3074.9705403072003 computed in 0.221 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.095 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]]}), with total cost 3.0
	Total score: 3110.9692203144 computed in 0.055 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]]}), with total cost 3.0
	Total score: 3102.9697003072 computed in 0.075 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]]}), with total cost 4.0
	Total score: 3106.9695603108 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3110.9692203144 computed in 0.050 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 63.03044000239985 computed in 0.213 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_11]0.103]}), with total cost 5.0
	Total score: 123.03049999999989 computed in 0.066 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_31]-0.704]}), with total cost 7.0
	Total score: 3110.9696203144 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_63]-0.713]}), with total cost 8.0
	Total score: 3110.9697203143996 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3062.9700803036008 computed in 0.041 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 3098.9695403155993 computed in 0.043 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 3098.969640315599 computed in 0.173 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 3098.969440315599 computed in 0.044 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_67]0.542]}), with total cost 8.0
	Total score: 3098.969840315599 computed in 0.044 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3098.9694803096004 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_31]1.92]}), with total cost 7.0
	Total score: 3074.9703403072003 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.91]}), with total cost 8.0
	Total score: 3074.9704403072 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.171 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.055 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9700203048005 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.261]}), with total cost 2.0
	Total score: 3110.9691203144 computed in 0.038 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_1]-0.265]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.186 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_0]0.501]}), with total cost 2.0
	Total score: 3102.9696003072 computed in 0.069 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_1]0.451]}), with total cost 3.0
	Total score: 3106.9694603108 computed in 0.077 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3110.9691203144 computed in 0.048 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.326]}), with total cost 2.0
	Total score: 3242.963900443998 computed in 0.077 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_127]-0.649]}), with total cost 9.0
	Total score: 3308.959200655493 computed in 0.081 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.489]}), with total cost 3.0
	Total score: 3218.9644204415986 computed in 0.053 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.57]}), with total cost 4.0
	Total score: 3254.9627204955973 computed in 0.087 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_91]-0.504]}), with total cost 8.0
	Total score: 3281.957750875982 computed in 0.248 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.073 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3050.9698403038974 computed in 0.029 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.055 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3065.9709003000007 computed in 0.045 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3074.9696603072002 computed in 0.064 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.068 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3302.960700539996 computed in 0.202 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3302.960800539996 computed in 0.092 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3326.9546010019785 computed in 0.075 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3062.9700803036008 computed in 0.045 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_11]0.103]}), with total cost 5.0
	Total score: 3098.9695403155993 computed in 0.048 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_31]-0.704]}), with total cost 7.0
	Total score: 3110.9696203144 computed in 0.042 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_63]-0.713]}), with total cost 8.0
	Total score: 3110.9697203143996 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 63.03044000239985 computed in 0.188 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 123.03049999999989 computed in 0.054 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 123.0305999999999 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 123.03039999999989 computed in 0.056 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_67]0.542]}), with total cost 8.0
	Total score: 123.03079999999989 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_31]1.92]}), with total cost 7.0
	Total score: 3110.9696203144 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.91]}), with total cost 8.0
	Total score: 3110.9697203143996 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9698203048006 computed in 0.186 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9700203048005 computed in 0.054 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.053 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.261]}), with total cost 2.0
	Total score: 3110.9691203144 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_1]-0.265]}), with total cost 3.0
	Total score: 3098.9695803096006 computed in 0.182 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_0]0.501]}), with total cost 2.0
	Total score: 3106.9693203111997 computed in 0.060 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_1]0.451]}), with total cost 3.0
	Total score: 3102.969620308 computed in 0.056 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3110.9691203144 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.326]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_127]-0.649]}), with total cost 9.0
	Total score: 3434.9529008399904 computed in 0.238 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.489]}), with total cost 3.0
	Total score: 3302.9613005159977 computed in 0.077 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.57]}), with total cost 4.0
	Total score: 3302.9614005159974 computed in 0.091 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_91]-0.504]}), with total cost 8.0
	Total score: 3326.9546010019785 computed in 0.072 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3050.9698403038974 computed in 0.036 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.216 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3074.9696603072002 computed in 0.046 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3098.9704203048004 computed in 0.053 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3098.9697203048004 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3287.9612005339964 computed in 0.077 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3230.964570428398 computed in 0.050 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3260.962870482398 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3350.9526810841767 computed in 0.222 seconds
Evaluating predicates: frozenset({activated0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.045 seconds
Evaluating predicates: frozenset({active0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.044 seconds
Evaluating predicates: frozenset({cold0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.098 seconds
Evaluating predicates: frozenset({deactivated0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.070 seconds
Evaluating predicates: frozenset({disengaged0}), with total cost 1.0
	Total score: 3224.9685503190003 computed in 0.088 seconds
Evaluating predicates: frozenset({engaged0}), with total cost 1.0
	Total score: 3098.9698203039998 computed in 0.206 seconds
Evaluating predicates: frozenset({hot0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.042 seconds
Evaluating predicates: frozenset({inactive0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.089 seconds
Evaluating predicates: frozenset({not_turned0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.064 seconds
Evaluating predicates: frozenset({occupied0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.041 seconds
Evaluating predicates: frozenset({off0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.091 seconds
Evaluating predicates: frozenset({on0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.042 seconds
Evaluating predicates: frozenset({rotated0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.046 seconds
Evaluating predicates: frozenset({turned0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.046 seconds
Evaluating predicates: frozenset({turned_off0}), with total cost 1.0
	Total score: 3182.9698903035996 computed in 0.214 seconds
Evaluating predicates: frozenset({turned_on0}), with total cost 1.0
	Total score: 3062.969980303601 computed in 0.041 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}) with heuristic 39.030199999999866

Hill climbing summary:
	On step 1, added NOT-[[0:surface].z<=[idx_0]1.6], with heuristic 39.030 (an improvement of 3059.939 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 118 candidates:
	NOT-[[0:surface].z<=[idx_0]1.6]
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.067 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 36 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 39 datapoints (3 positive)
Reduced dataset size from 39 to 6
Loss: 0.69521, iter: 0/10000
Loss: 0.00072, iter: 1000/10000
Loss: 0.00013, iter: 2000/10000
Loss: 0.00004, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: 0.04240, iter: 0/1000
Loss: -5.60309, iter: 1000/1000
Loaded best model with loss: -6.44776

Learning neural sampler for NSRT Op1
Generated 3 positive and 189 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 192 datapoints (3 positive)
Reduced dataset size from 192 to 6
Loss: 0.69393, iter: 0/10000
Loss: 0.00028, iter: 1000/10000
Loss: 0.00006, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.02622, iter: 0/1000
Loss: -5.77493, iter: 1000/1000
Loaded best model with loss: -6.04239

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 1 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 2 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 3 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 4 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 5 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 6 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 7 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 8 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 9 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 10 / 10: SOLVED
Tasks solved: 10 / 10
Average time for successes: 0.15881 seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 10, 'num_total': 10, 'avg_suc_time': 0.15880557261407374, 'avg_ref_cost': 15.160000000000002, 'min_num_samples': 0.0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 1.0, 'max_skeletons_optimized': 1.0, 'num_solve_timeouts': 0, 'num_solve_failures': 0, 'num_execution_timeouts': 0, 'num_execution_failures': 0, 'avg_num_samples': 0.0, 'avg_num_skeletons_optimized': 1.0, 'avg_num_nodes_expanded': 2.0, 'avg_num_nodes_created': 12.0, 'avg_num_nsrts': 2.0, 'avg_num_preds': 3.0, 'avg_plan_length': 0.0, 'avg_num_failures_discovered': 0.0, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 31.204897952266037, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 236})
Wrote out test results to results/kitchen__grammar_search_invention__0__all____kitchen_boil_kettle-ours__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 293.69173 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_diverse --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only False --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 1
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7f213c692e60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_diverse', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=False, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7f213c692ef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=1, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
cold
holding
inactive
connected
kettle_on
unoccupied
released
attached
placed
removed_from
kettle_off
placed_on
engaged
grasping
free
gripper_contact
active
hot
on
detached
letting_go
positioned_on
off
gripping
empty
not_on
releasing
disengaged
deactivated
occupied
clutching
gripper_not_touching
gripper_near
turned_off
gripper_adjacent
removed
gripper_far
activated
kettle_positioned
turned_on
gripper_touching
not_gripping
VLM proposed a total of 150 atoms.
Of these, 94 were valid and unique.
For the 42 predicates, there were 214 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.262) 2.0
NOT-((0:kettle).x<=[idx 0]-0.262) 2.0
((0:kettle).y<=[idx 0]0.51) 2.0
Forall[0:kettle].[((0:kettle).y<=[idx 0]0.51)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 0]0.51)(0)] 3.0
NOT-((0:kettle).y<=[idx 0]0.51) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.325) 2.0
NOT-((0:knob).angle<=[idx 0]-0.325) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:knob).angle<=[idx 1]-0.488) 3.0
NOT-((0:knob).angle<=[idx 1]-0.488) 3.0
((0:kettle).z<=[idx 2]1.88) 3.0
Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-((0:kettle).z<=[idx 2]1.88) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:knob).angle<=[idx 3]-0.569) 4.0
NOT-((0:knob).angle<=[idx 3]-0.569) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:gripper).x<=[idx 11]-0.245) 5.0
Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-((0:gripper).x<=[idx 11]-0.245) 5.0
((0:gripper).y<=[idx 15]0.54) 6.0
Forall[0:gripper].[((0:gripper).y<=[idx 15]0.54)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 15]0.54)(0)] 7.0
NOT-((0:gripper).y<=[idx 15]0.54) 6.0
((0:kettle).y<=[idx 15]0.422) 6.0
Forall[0:kettle].[((0:kettle).y<=[idx 15]0.422)(0)] 7.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 15]0.422)(0)] 7.0
NOT-((0:kettle).y<=[idx 15]0.422) 6.0
((0:surface).z<=[idx 18]1.6) 6.0
NOT-((0:surface).z<=[idx 18]1.6) 6.0
((0:gripper).x<=[idx 19]-0.254) 6.0
Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-((0:gripper).x<=[idx 19]-0.254) 6.0
((0:knob).angle<=[idx 27]-0.508) 6.0
NOT-((0:knob).angle<=[idx 27]-0.508) 6.0
((0:knob).angle<=[idx 31]-0.64) 7.0
NOT-((0:knob).angle<=[idx 31]-0.64) 7.0
Forall[0:knob].[NOT-((0:knob).angle<=[idx 31]-0.64)(0)] 8.0
NOT-Forall[0:knob].[NOT-((0:knob).angle<=[idx 31]-0.64)(0)] 8.0
((0:kettle).y<=[idx 62]0.601) 7.0
Forall[0:kettle].[((0:kettle).y<=[idx 62]0.601)(0)] 8.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 62]0.601)(0)] 8.0
NOT-((0:kettle).y<=[idx 62]0.601) 7.0
((0:surface).z<=[idx 62]1.6) 7.0
NOT-((0:surface).z<=[idx 62]1.6) 7.0
((0:gripper).z<=[idx 63]1.92) 8.0
NOT-((0:gripper).z<=[idx 63]1.92) 8.0
((0:gripper).qx<=[idx 63]-0.711) 8.0
NOT-((0:gripper).qx<=[idx 63]-0.711) 8.0
((0:knob).angle<=[idx 127]-0.648) 9.0
NOT-((0:knob).angle<=[idx 127]-0.648) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
((0:gripper).qw<=[idx 171]0.113) 9.0
Forall[0:gripper].[((0:gripper).qw<=[idx 171]0.113)(0)] 10.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3050.9704802952006 computed in 0.096 seconds


Starting hill climbing at state frozenset() with heuristic 3050.9704802952006
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3050.970060307201 computed in 0.058 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_171]0.113][0]]}), with total cost 10.0
	Total score: 3098.9700403167994 computed in 0.077 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.082 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 51.03095999999989 computed in 0.064 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 51.03105999999989 computed in 0.061 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_15]0.54][0]]}), with total cost 7.0
	Total score: 51.03105999999989 computed in 0.058 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 51.03075999999989 computed in 0.058 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.230 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.062 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.51][0]]}), with total cost 3.0
	Total score: 3082.9701403047998 computed in 0.075 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_15]0.422][0]]}), with total cost 7.0
	Total score: 3066.9708603000004 computed in 0.068 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.601][0]]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.204 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3110.9692203179998 computed in 0.071 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3110.9693203179995 computed in 0.066 seconds
Evaluating predicates: frozenset({Forall[0:knob].[NOT-[[0:knob].angle<=[idx_31]-0.64][0]]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.067 seconds
Evaluating predicates: frozenset({KettleBoiling}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.182 seconds
Evaluating predicates: frozenset({KnobAndBurnerLinked}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.070 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3050.970060307201 computed in 0.044 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 3098.969640316799 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 3098.9697403167993 computed in 0.176 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_15]0.54][0]]}), with total cost 7.0
	Total score: 3098.9697403167993 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 3098.969440316799 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3050.9705403000007 computed in 0.052 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.51][0]]}), with total cost 3.0
	Total score: 3070.970180306 computed in 0.174 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_15]0.422][0]]}), with total cost 7.0
	Total score: 3090.9701003119994 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.601][0]]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3110.9692203179998 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3110.9693203179995 computed in 0.041 seconds
Evaluating predicates: frozenset({NOT-Forall[0:knob].[NOT-[[0:knob].angle<=[idx_31]-0.64][0]]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.075 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_63]-0.711]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.192 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3050.969960307201 computed in 0.043 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 3098.9695403167993 computed in 0.071 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 3098.969640316799 computed in 0.075 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_15]0.54]}), with total cost 6.0
	Total score: 3098.969640316799 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 3098.9693403167994 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3050.9704403000005 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.178 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3050.9709802952007 computed in 0.068 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.184 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_0]0.51]}), with total cost 2.0
	Total score: 3070.970080306 computed in 0.066 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_15]0.422]}), with total cost 6.0
	Total score: 3090.9700003119992 computed in 0.052 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_62]0.601]}), with total cost 7.0
	Total score: 3110.9696203179997 computed in 0.040 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3110.9691203179996 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3110.9692203179998 computed in 0.155 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 3197.9648004439973 computed in 0.069 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_127]-0.648]}), with total cost 9.0
	Total score: 3119.968650381898 computed in 0.083 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.488]}), with total cost 3.0
	Total score: 3140.967360376799 computed in 0.045 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_27]-0.508]}), with total cost 6.0
	Total score: 3173.9672703899987 computed in 0.077 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_31]-0.64]}), with total cost 7.0
	Total score: 3119.968450381898 computed in 0.082 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.569]}), with total cost 4.0
	Total score: 3098.9695603216005 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3026.9702003014977 computed in 0.030 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.186 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3044.9709003021003 computed in 0.046 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3056.9698403072002 computed in 0.048 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.077 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_18]1.6]}), with total cost 6.0
	Total score: 3326.9544009911797 computed in 0.098 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3122.9685003359996 computed in 0.090 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_62]1.6]}), with total cost 7.0
	Total score: 3146.967820379199 computed in 0.237 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3122.9686003359993 computed in 0.109 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3050.969960307201 computed in 0.041 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_171]0.113]}), with total cost 9.0
	Total score: 3098.9699403167992 computed in 0.050 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_63]-0.711]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.039 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.051 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 51.03085999999989 computed in 0.185 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 51.03095999999989 computed in 0.065 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_15]0.54]}), with total cost 6.0
	Total score: 51.03095999999989 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 51.03065999999989 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 3110.9697203179994 computed in 0.195 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.084 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3050.9707802952007 computed in 0.069 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3050.9709802952007 computed in 0.060 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 3050.9704403000005 computed in 0.187 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_0]0.51]}), with total cost 2.0
	Total score: 3082.9700403047996 computed in 0.064 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_15]0.422]}), with total cost 6.0
	Total score: 3066.9707603 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_62]0.601]}), with total cost 7.0
	Total score: 3110.9696203179997 computed in 0.061 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3110.9691203179996 computed in 0.228 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3110.9692203179998 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.065 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_127]-0.648]}), with total cost 9.0
	Total score: 3290.9601006239936 computed in 0.167 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.488]}), with total cost 3.0
	Total score: 3122.96910033 computed in 0.084 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_27]-0.508]}), with total cost 6.0
	Total score: 3218.9641205159955 computed in 0.199 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_31]-0.64]}), with total cost 7.0
	Total score: 3290.9599006239937 computed in 0.113 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.569]}), with total cost 4.0
	Total score: 3122.9692003299997 computed in 0.103 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3026.9702003014977 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.220 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3056.9698403072002 computed in 0.068 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3050.9713802952006 computed in 0.073 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3050.9706802952005 computed in 0.078 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3107.9693003134994 computed in 0.093 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_18]1.6]}), with total cost 6.0
	Total score: 3176.967060398399 computed in 0.227 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3146.9669403839985 computed in 0.047 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_62]1.6]}), with total cost 7.0
	Total score: 3122.969020336 computed in 0.091 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3161.9668303833987 computed in 0.090 seconds
Evaluating predicates: frozenset({activated0}), with total cost 1.0
	Total score: 3114.9705803112 computed in 0.358 seconds
Evaluating predicates: frozenset({active0}), with total cost 1.0
	Total score: 3154.9710603016 computed in 0.135 seconds
Evaluating predicates: frozenset({cold0}), with total cost 1.0
	Total score: 3322.969020315201 computed in 0.292 seconds
Evaluating predicates: frozenset({deactivated0}), with total cost 1.0
	Total score: 3095.970530298901 computed in 0.084 seconds
Evaluating predicates: frozenset({empty0}), with total cost 1.0
	Total score: 3110.969020318 computed in 0.039 seconds
Evaluating predicates: frozenset({engaged0}), with total cost 1.0
	Total score: 3290.9675803252003 computed in 0.326 seconds
Evaluating predicates: frozenset({free0}), with total cost 1.0
	Total score: 3110.969020318 computed in 0.039 seconds
Evaluating predicates: frozenset({gripper_adjacent0}), with total cost 1.0
	Total score: 3110.969020318 computed in 0.040 seconds
Evaluating predicates: frozenset({gripper_adjacent1}), with total cost 1.0
	Total score: 3224.9686003189 computed in 0.290 seconds
Evaluating predicates: frozenset({gripper_contact0}), with total cost 1.0
	Total score: 3066.9701403024005 computed in 0.081 seconds
Evaluating predicates: frozenset({gripper_far0}), with total cost 1.0
	Total score: 3066.9704202980006 computed in 0.082 seconds
Evaluating predicates: frozenset({gripper_far1}), with total cost 1.0
	Total score: 5348.952640496601 computed in 0.367 seconds
Evaluating predicates: frozenset({gripper_near0}), with total cost 1.0
	Total score: 3066.9701403024005 computed in 0.211 seconds
Evaluating predicates: frozenset({gripper_not_touching0}), with total cost 1.0
	Total score: 3066.9704202980006 computed in 0.066 seconds
Evaluating predicates: frozenset({gripper_not_touching1}), with total cost 1.0
	Total score: 5348.952640496601 computed in 0.342 seconds
Evaluating predicates: frozenset({gripper_touching0}), with total cost 1.0
	Total score: 3066.9701403024005 computed in 0.069 seconds
Evaluating predicates: frozenset({hot0}), with total cost 1.0
	Total score: 3082.9699403048003 computed in 0.080 seconds
Evaluating predicates: frozenset({inactive0}), with total cost 1.0
	Total score: 3140.9707202978007 computed in 0.279 seconds
Evaluating predicates: frozenset({kettle_off0}), with total cost 1.0
	Total score: 3140.9707202978007 computed in 0.137 seconds
Evaluating predicates: frozenset({kettle_on0}), with total cost 1.0
	Total score: 3082.9699403048003 computed in 0.234 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}) with heuristic 39.030199999999866

Hill climbing summary:
	On step 1, added NOT-[[0:surface].z<=[idx_0]1.6], with heuristic 39.030 (an improvement of 3011.940 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 122 candidates:
	NOT-[[0:surface].z<=[idx_0]1.6]
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.062 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 36 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 39 datapoints (3 positive)
Reduced dataset size from 39 to 6
Loss: 0.69268, iter: 0/10000
Loss: 0.00049, iter: 1000/10000
Loss: 0.00010, iter: 2000/10000
Loss: 0.00004, iter: 3000/10000
Loss: 0.00002, iter: 4000/10000
Loss: 0.00001, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: 0.00826, iter: 0/1000
Loss: -6.04083, iter: 1000/1000
Loaded best model with loss: -6.56879

Learning neural sampler for NSRT Op1
Generated 3 positive and 189 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 192 datapoints (3 positive)
Reduced dataset size from 192 to 6
Loss: 0.69479, iter: 0/10000
Loss: 0.00028, iter: 1000/10000
Loss: 0.00006, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.00200, iter: 0/1000
Loss: -6.22447, iter: 1000/1000
Loaded best model with loss: -6.30952

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 1 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 2 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 3 / 10: Policy failed to reach goal
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 4 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 5 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 6 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 7 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 8 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 9 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 10 / 10: SOLVED
Tasks solved: 9 / 10
Average time for successes: 0.14874 seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 9, 'num_total': 10, 'avg_suc_time': 0.1487449505366385, 'avg_ref_cost': 21.983333333333334, 'min_num_samples': 0.0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 1.0, 'max_skeletons_optimized': 1.0, 'num_solve_timeouts': 0, 'num_solve_failures': 0, 'num_execution_timeouts': 0, 'num_execution_failures': 0, 'avg_num_samples': 0.0, 'avg_num_skeletons_optimized': 1.0, 'avg_num_nodes_expanded': 2.0, 'avg_num_nodes_created': 12.0, 'avg_num_nsrts': 2.0, 'avg_num_preds': 3.0, 'avg_plan_length': 0.0, 'avg_num_failures_discovered': 0.0, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 36.70216781506315, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 244})
Wrote out test results to results/kitchen__grammar_search_invention__1__all____kitchen_boil_kettle-ours__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 272.30445 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_diverse --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only False --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 2
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7fbebcd0ae60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_diverse', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=False, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7fbebcd0aef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=2, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
cold
holding
inactive
connected
not_at
positioned
kettle_on
unoccupied
attached
removed_from
kettle_off
placed_on
located
engaged
gripper_contact
grasping
free
turned
active
hot
on
detached
letting_go
positioned_on
off
not_turned
empty
releasing
disengaged
deactivated
occupied
gripper_not_touching
clutching
at
gripper_near
rotated
gripper_adjacent
turned_off
gripper_far
kettle_positioned
activated
turned_on
gripper_touching
VLM proposed a total of 143 atoms.
Of these, 95 were valid and unique.
For the 43 predicates, there were 223 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.263) 2.0
NOT-((0:kettle).x<=[idx 0]-0.263) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.76) 2.0
NOT-((0:knob).angle<=[idx 0]-0.76) 2.0
Forall[0:knob].[NOT-((0:knob).angle<=[idx 0]-0.76)(0)] 3.0
NOT-Forall[0:knob].[NOT-((0:knob).angle<=[idx 0]-0.76)(0)] 3.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:kettle).y<=[idx 1]0.479) 3.0
Forall[0:kettle].[((0:kettle).y<=[idx 1]0.479)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 1]0.479)(0)] 4.0
NOT-((0:kettle).y<=[idx 1]0.479) 3.0
((0:surface).z<=[idx 1]1.6) 3.0
NOT-((0:surface).z<=[idx 1]1.6) 3.0
((0:knob).angle<=[idx 2]-0.38) 3.0
NOT-((0:knob).angle<=[idx 2]-0.38) 3.0
((0:gripper).y<=[idx 3]0.541) 4.0
Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-((0:gripper).y<=[idx 3]0.541) 4.0
((0:knob).angle<=[idx 4]-0.57) 4.0
NOT-((0:knob).angle<=[idx 4]-0.57) 4.0
((0:surface).z<=[idx 5]1.6) 4.0
NOT-((0:surface).z<=[idx 5]1.6) 4.0
((0:kettle).z<=[idx 6]1.88) 4.0
Forall[0:kettle].[((0:kettle).z<=[idx 6]1.88)(0)] 5.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 6]1.88)(0)] 5.0
NOT-((0:kettle).z<=[idx 6]1.88) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:kettle).y<=[idx 7]0.448) 5.0
Forall[0:kettle].[((0:kettle).y<=[idx 7]0.448)(0)] 6.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 7]0.448)(0)] 6.0
NOT-((0:kettle).y<=[idx 7]0.448) 5.0
((0:surface).z<=[idx 9]1.6) 5.0
NOT-((0:surface).z<=[idx 9]1.6) 5.0
((0:knob).angle<=[idx 12]-0.475) 5.0
NOT-((0:knob).angle<=[idx 12]-0.475) 5.0
((0:kettle).x<=[idx 14]-0.257) 5.0
Forall[0:kettle].[((0:kettle).x<=[idx 14]-0.257)(0)] 6.0
NOT-Forall[0:kettle].[((0:kettle).x<=[idx 14]-0.257)(0)] 6.0
NOT-((0:kettle).x<=[idx 14]-0.257) 5.0
((0:knob).angle<=[idx 20]-0.522) 6.0
NOT-((0:knob).angle<=[idx 20]-0.522) 6.0
((0:surface).z<=[idx 25]1.6) 6.0
NOT-((0:surface).z<=[idx 25]1.6) 6.0
((0:gripper).qw<=[idx 43]0.111) 7.0
Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-((0:gripper).qw<=[idx 43]0.111) 7.0
((0:gripper).z<=[idx 63]1.92) 8.0
NOT-((0:gripper).z<=[idx 63]1.92) 8.0
((0:gripper).qw<=[idx 75]0.107) 8.0
Forall[0:gripper].[((0:gripper).qw<=[idx 75]0.107)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 75]0.107)(0)] 9.0
NOT-((0:gripper).qw<=[idx 75]0.107) 8.0
((0:gripper).z<=[idx 127]1.92) 9.0
Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-((0:gripper).z<=[idx 127]1.92) 9.0
((0:gripper).qx<=[idx 127]-0.713) 9.0
NOT-((0:gripper).qx<=[idx 127]-0.713) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3122.9692803072 computed in 0.058 seconds


Starting hill climbing at state frozenset() with heuristic 3122.9692803072
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3086.9698203059993 computed in 0.042 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 3098.9705602987997 computed in 0.050 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_75]0.107][0]]}), with total cost 9.0
	Total score: 3098.9706602988 computed in 0.048 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.047 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 87.03039999999989 computed in 0.069 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 87.03049999999989 computed in 0.075 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.193 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3146.9692003288 computed in 0.040 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.055 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_14]-0.257][0]]}), with total cost 6.0
	Total score: 3146.9684403323995 computed in 0.062 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.479][0]]}), with total cost 4.0
	Total score: 3106.9700003015996 computed in 0.175 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_7]0.448][0]]}), with total cost 6.0
	Total score: 3114.9700403044 computed in 0.063 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3146.9681403324 computed in 0.063 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_6]1.88][0]]}), with total cost 5.0
	Total score: 3146.9687003251997 computed in 0.062 seconds
Evaluating predicates: frozenset({Forall[0:knob].[NOT-[[0:knob].angle<=[idx_0]-0.76][0]]}), with total cost 3.0
	Total score: 3146.9685003252 computed in 0.167 seconds
Evaluating predicates: frozenset({KettleBoiling}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.054 seconds
Evaluating predicates: frozenset({KnobAndBurnerLinked}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.074 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.072 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 87.03079999999989 computed in 0.166 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_75]0.107][0]]}), with total cost 9.0
	Total score: 87.03089999999989 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3086.9698203059993 computed in 0.043 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 3098.9701602988 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 3098.9702602988 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3074.9700603048004 computed in 0.161 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3146.9692003252 computed in 0.062 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_14]-0.257][0]]}), with total cost 6.0
	Total score: 3146.9688003287997 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.479][0]]}), with total cost 4.0
	Total score: 3106.969800309599 computed in 0.068 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_7]0.448][0]]}), with total cost 6.0
	Total score: 3126.9694003191994 computed in 0.160 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3146.9685003288 computed in 0.038 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_6]1.88][0]]}), with total cost 5.0
	Total score: 3146.9687003288 computed in 0.037 seconds
Evaluating predicates: frozenset({NOT-Forall[0:knob].[NOT-[[0:knob].angle<=[idx_0]-0.76][0]]}), with total cost 3.0
	Total score: 3146.9685003288 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.066 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 87.03069999999988 computed in 0.171 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_75]0.107]}), with total cost 8.0
	Total score: 87.03079999999989 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_127]-0.713]}), with total cost 9.0
	Total score: 3146.9687403323996 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3086.969720305999 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 3098.9700602988 computed in 0.049 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 3098.9701602988 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3074.9699603048 computed in 0.170 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_127]1.92]}), with total cost 9.0
	Total score: 3146.9691003251996 computed in 0.065 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 3146.9690003251994 computed in 0.067 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.174 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3122.9697803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.263]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_14]-0.257]}), with total cost 5.0
	Total score: 3146.9687003288 computed in 0.172 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_1]0.479]}), with total cost 3.0
	Total score: 3106.9697003095994 computed in 0.101 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_7]0.448]}), with total cost 5.0
	Total score: 3126.9693003191996 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3146.9684003288 computed in 0.041 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_6]1.88]}), with total cost 4.0
	Total score: 3146.9686003287998 computed in 0.041 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.76]}), with total cost 2.0
	Total score: 3218.9634504979967 computed in 0.088 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_12]-0.475]}), with total cost 5.0
	Total score: 3236.9635404739975 computed in 0.045 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_20]-0.522]}), with total cost 6.0
	Total score: 3281.9569209185806 computed in 0.197 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_2]-0.38]}), with total cost 3.0
	Total score: 3152.966700394499 computed in 0.072 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_4]-0.57]}), with total cost 4.0
	Total score: 3158.966920381599 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3026.9702003014977 computed in 0.030 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3086.9702703063 computed in 0.167 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3056.9698403054003 computed in 0.049 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3218.9630005231948 computed in 0.116 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_1]1.6]}), with total cost 3.0
	Total score: 39.03029999999987 computed in 0.063 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_25]1.6]}), with total cost 6.0
	Total score: 3218.963040602391 computed in 0.073 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_5]1.6]}), with total cost 4.0
	Total score: 3182.9656004259973 computed in 0.096 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_9]1.6]}), with total cost 5.0
	Total score: 3182.9657004259975 computed in 0.210 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3086.969720305999 computed in 0.041 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 3098.9704602988 computed in 0.047 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_75]0.107]}), with total cost 8.0
	Total score: 3098.9705602987997 computed in 0.047 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_127]-0.713]}), with total cost 9.0
	Total score: 3146.9691003288 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.048 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 87.03029999999988 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 87.03039999999989 computed in 0.180 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.061 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_127]1.92]}), with total cost 9.0
	Total score: 3146.9691003288 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 3146.9690003287997 computed in 0.039 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3122.9695803072 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3122.9697803072 computed in 0.183 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.056 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.263]}), with total cost 2.0
	Total score: 3074.9699603048 computed in 0.050 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_14]-0.257]}), with total cost 5.0
	Total score: 3146.9683403323997 computed in 0.066 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_1]0.479]}), with total cost 3.0
	Total score: 3106.9699003016 computed in 0.191 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_7]0.448]}), with total cost 5.0
	Total score: 3114.9699403044 computed in 0.061 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3146.9680403323996 computed in 0.061 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_6]1.88]}), with total cost 4.0
	Total score: 3146.9686003251995 computed in 0.194 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.76]}), with total cost 2.0
	Total score: 3218.963720479997 computed in 0.111 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_12]-0.475]}), with total cost 5.0
	Total score: 3242.963300485997 computed in 0.082 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_20]-0.522]}), with total cost 6.0
	Total score: 3326.953321088375 computed in 0.071 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_2]-0.38]}), with total cost 3.0
	Total score: 39.03029999999987 computed in 0.079 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_4]-0.57]}), with total cost 4.0
	Total score: 3242.963200485997 computed in 0.249 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3026.9702003014977 computed in 0.044 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3056.9698403054003 computed in 0.046 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3122.9701803072 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3122.9694803072 computed in 0.189 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3218.963000520795 computed in 0.088 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_1]1.6]}), with total cost 3.0
	Total score: 3197.965350425998 computed in 0.073 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_25]1.6]}), with total cost 6.0
	Total score: 3176.966400451196 computed in 0.083 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_5]1.6]}), with total cost 4.0
	Total score: 3161.9668303833987 computed in 0.059 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_9]1.6]}), with total cost 5.0
	Total score: 3146.9671403887987 computed in 0.053 seconds
Evaluating predicates: frozenset({activated0}), with total cost 1.0
	Total score: 3218.9686603144 computed in 0.311 seconds
Evaluating predicates: frozenset({active0}), with total cost 1.0
	Total score: 3218.9686603144 computed in 0.305 seconds
Evaluating predicates: frozenset({cold0}), with total cost 1.0
	Total score: 3128.9694403088 computed in 0.103 seconds
Evaluating predicates: frozenset({deactivated0}), with total cost 1.0
	Total score: 4586.47129985352 computed in 0.858 seconds
Evaluating predicates: frozenset({disengaged0}), with total cost 1.0
	Total score: 4586.47129985352 computed in 0.628 seconds
Evaluating predicates: frozenset({empty0}), with total cost 1.0
	Total score: 3146.9683003288 computed in 0.039 seconds
Evaluating predicates: frozenset({engaged0}), with total cost 1.0
	Total score: 3218.9686603144 computed in 0.298 seconds
Evaluating predicates: frozenset({free0}), with total cost 1.0
	Total score: 3146.9683003288 computed in 0.039 seconds
Evaluating predicates: frozenset({gripper_adjacent0}), with total cost 1.0
	Total score: 3178.9675003439997 computed in 0.051 seconds
Evaluating predicates: frozenset({gripper_adjacent1}), with total cost 1.0
	Total score: 3224.9682403257993 computed in 0.130 seconds
Evaluating predicates: frozenset({gripper_contact0}), with total cost 1.0
	Total score: 3098.9700603004003 computed in 0.212 seconds
Evaluating predicates: frozenset({gripper_far1}), with total cost 1.0
	Total score: 4758.961880383801 computed in 0.347 seconds
Evaluating predicates: frozenset({gripper_near0}), with total cost 1.0
	Total score: 3098.9702602984 computed in 0.084 seconds
Evaluating predicates: frozenset({gripper_not_touching0}), with total cost 1.0
	Total score: 3150.9690603120002 computed in 0.069 seconds
Evaluating predicates: frozenset({gripper_not_touching1}), with total cost 1.0
	Total score: 4758.961880383801 computed in 0.386 seconds
Evaluating predicates: frozenset({gripper_touching0}), with total cost 1.0
	Total score: 3098.9700603004003 computed in 0.066 seconds
Evaluating predicates: frozenset({hot0}), with total cost 1.0
	Total score: 3098.9702602984 computed in 0.231 seconds
Evaluating predicates: frozenset({inactive0}), with total cost 1.0
	Total score: 3140.9703603095995 computed in 0.134 seconds
Evaluating predicates: frozenset({kettle_off0}), with total cost 1.0
	Total score: 3140.9703603095995 computed in 0.288 seconds
Evaluating predicates: frozenset({kettle_on0}), with total cost 1.0
	Total score: 3098.9702602984 computed in 0.084 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:surface].z<=[idx_1]1.6]}) with heuristic 39.03029999999987

Hill climbing summary:
	On step 1, added NOT-[[0:surface].z<=[idx_1]1.6], with heuristic 39.030 (an improvement of 3083.939 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 122 candidates:
	NOT-[[0:surface].z<=[idx_1]1.6]
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_1]1.6]}), with total cost 3.0
	Total score: 39.03029999999987 computed in 0.063 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_1]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_1]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_1]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 36 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 39 datapoints (3 positive)
Reduced dataset size from 39 to 6
Loss: 0.68888, iter: 0/10000
Loss: 0.00105, iter: 1000/10000
Loss: 0.00022, iter: 2000/10000
Loss: 0.00008, iter: 3000/10000
Loss: 0.00004, iter: 4000/10000
Loss: 0.00002, iter: 5000/10000
Loss: 0.00001, iter: 6000/10000
Loss: 0.00001, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: 0.04669, iter: 0/1000
Loss: -5.76478, iter: 1000/1000
Loaded best model with loss: -6.58385

Learning neural sampler for NSRT Op1
Generated 3 positive and 189 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 192 datapoints (3 positive)
Reduced dataset size from 192 to 6
Loss: 0.68894, iter: 0/10000
Loss: 0.00094, iter: 1000/10000
Loss: 0.00020, iter: 2000/10000
Loss: 0.00007, iter: 3000/10000
Loss: 0.00003, iter: 4000/10000
Loss: 0.00002, iter: 5000/10000
Loss: 0.00001, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.00901, iter: 0/1000
Loss: -5.89892, iter: 1000/1000
Loaded best model with loss: -6.27779

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_1]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_1]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_1]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
Task 1 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 2 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 3 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 4 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 5 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 6 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 7 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 8 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 9 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 10 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
Tasks solved: 0 / 10
Average time for successes: inf seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 0, 'num_total': 10, 'avg_suc_time': inf, 'avg_ref_cost': inf, 'min_num_samples': 0.0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 1.0, 'max_skeletons_optimized': 1.0, 'num_solve_timeouts': 0, 'num_solve_failures': 0, 'num_execution_timeouts': 0, 'num_execution_failures': 10, 'avg_num_samples': 0.0, 'avg_num_skeletons_optimized': 1.0, 'avg_num_nodes_expanded': 2.0, 'avg_num_nodes_created': 12.0, 'avg_num_nsrts': 2.0, 'avg_num_preds': 3.0, 'avg_plan_length': 0.0, 'avg_num_failures_discovered': 0.0, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 35.12642660085112, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 244})
Wrote out test results to results/kitchen__grammar_search_invention__2__all____kitchen_boil_kettle-ours__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 247.36387 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_diverse --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only False --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 3
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7ffa94cfee60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_diverse', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=False, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7ffa94cfeef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=3, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
inactive
not_at
connected
positioned
kettle_on
attached
kettle_off
located
turned
gripper_contact
active
on
detached
off
not_turned
gripper_not_touching
at
gripper_near
rotated
gripper_adjacent
gripper_far
kettle_positioned
gripper_touching
VLM proposed a total of 118 atoms.
Of these, 50 were valid and unique.
For the 23 predicates, there were 142 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.263) 2.0
NOT-((0:kettle).x<=[idx 0]-0.263) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.325) 2.0
NOT-((0:knob).angle<=[idx 0]-0.325) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:knob).angle<=[idx 1]-0.487) 3.0
NOT-((0:knob).angle<=[idx 1]-0.487) 3.0
((0:kettle).z<=[idx 2]1.88) 3.0
Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-((0:kettle).z<=[idx 2]1.88) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:gripper).y<=[idx 3]0.541) 4.0
Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-((0:gripper).y<=[idx 3]0.541) 4.0
((0:kettle).y<=[idx 3]0.455) 4.0
Forall[0:kettle].[((0:kettle).y<=[idx 3]0.455)(0)] 5.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 3]0.455)(0)] 5.0
NOT-((0:kettle).y<=[idx 3]0.455) 4.0
((0:knob).angle<=[idx 3]-0.568) 4.0
NOT-((0:knob).angle<=[idx 3]-0.568) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:kettle).z<=[idx 16]1.88) 6.0
Forall[0:kettle].[((0:kettle).z<=[idx 16]1.88)(0)] 7.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 16]1.88)(0)] 7.0
NOT-((0:kettle).z<=[idx 16]1.88) 6.0
((0:gripper).qw<=[idx 43]0.111) 7.0
Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-((0:gripper).qw<=[idx 43]0.111) 7.0
((0:kettle).y<=[idx 43]0.468) 7.0
Forall[0:kettle].[((0:kettle).y<=[idx 43]0.468)(0)] 8.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 43]0.468)(0)] 8.0
NOT-((0:kettle).y<=[idx 43]0.468) 7.0
((0:gripper).x<=[idx 51]-0.25) 7.0
Forall[0:gripper].[((0:gripper).x<=[idx 51]-0.25)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 51]-0.25)(0)] 8.0
NOT-((0:gripper).x<=[idx 51]-0.25) 7.0
((0:kettle).y<=[idx 62]0.602) 7.0
Forall[0:kettle].[((0:kettle).y<=[idx 62]0.602)(0)] 8.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 62]0.602)(0)] 8.0
NOT-((0:kettle).y<=[idx 62]0.602) 7.0
((0:knob).angle<=[idx 91]-0.502) 8.0
NOT-((0:knob).angle<=[idx 91]-0.502) 8.0
((0:surface).z<=[idx 98]1.6) 8.0
NOT-((0:surface).z<=[idx 98]1.6) 8.0
((0:gripper).qx<=[idx 127]-0.713) 9.0
NOT-((0:gripper).qx<=[idx 127]-0.713) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
((0:kettle).y<=[idx 222]0.601) 9.0
Forall[0:kettle].[((0:kettle).y<=[idx 222]0.601)(0)] 10.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 222]0.601)(0)] 10.0
NOT-((0:kettle).y<=[idx 222]0.601) 9.0
((0:surface).x<=[idx 254]0.219) 9.0
NOT-((0:surface).x<=[idx 254]0.219) 9.0
((0:gripper).z<=[idx 255]1.92) 10.0
Forall[0:gripper].[((0:gripper).z<=[idx 255]1.92)(0)] 11.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 255]1.92)(0)] 11.0
NOT-((0:gripper).z<=[idx 255]1.92) 10.0
((0:gripper).qx<=[idx 255]-0.715) 10.0
NOT-((0:gripper).qx<=[idx 255]-0.715) 10.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3098.9700003 computed in 0.056 seconds


Starting hill climbing at state frozenset() with heuristic 3098.9700003
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3062.970060308401 computed in 0.043 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 3062.9706803060003 computed in 0.046 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.049 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_51]-0.25][0]]}), with total cost 8.0
	Total score: 87.03079999999989 computed in 0.171 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 87.03039999999989 computed in 0.060 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 87.03049999999989 computed in 0.063 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.066 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_255]1.92][0]]}), with total cost 11.0
	Total score: 3074.9714602892 computed in 0.045 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.186 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_222]0.601][0]]}), with total cost 10.0
	Total score: 3074.9710003 computed in 0.069 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_3]0.455][0]]}), with total cost 5.0
	Total score: 3090.9706602968 computed in 0.063 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_43]0.468][0]]}), with total cost 8.0
	Total score: 3082.9711202936 computed in 0.065 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.602][0]]}), with total cost 8.0
	Total score: 3074.9708002999996 computed in 0.177 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_16]1.88][0]]}), with total cost 7.0
	Total score: 3074.9707002964 computed in 0.065 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3074.9704002964 computed in 0.067 seconds
Evaluating predicates: frozenset({KettleBoiling}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.071 seconds
Evaluating predicates: frozenset({KnobAndBurnerLinked}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.186 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 63.030300002399876 computed in 0.069 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 87.03079999999989 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3062.970060308401 computed in 0.043 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_51]-0.25][0]]}), with total cost 8.0
	Total score: 3062.9706803060003 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 3062.9702803060004 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 3062.9703803060006 computed in 0.195 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3074.9700603048004 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_255]1.92][0]]}), with total cost 11.0
	Total score: 3074.9711002999998 computed in 0.072 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.064 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_222]0.601][0]]}), with total cost 10.0
	Total score: 3074.9713602892 computed in 0.040 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_3]0.455][0]]}), with total cost 5.0
	Total score: 3078.9706202939997 computed in 0.170 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_43]0.468][0]]}), with total cost 8.0
	Total score: 3082.9706802987994 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.602][0]]}), with total cost 8.0
	Total score: 3074.9711602892 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_16]1.88][0]]}), with total cost 7.0
	Total score: 3074.9710602892 computed in 0.044 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3074.9707602892 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.191 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 87.03069999999988 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_127]-0.713]}), with total cost 9.0
	Total score: 3074.9709002964 computed in 0.066 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_255]-0.715]}), with total cost 10.0
	Total score: 3074.9710002964002 computed in 0.089 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3062.969960308401 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_51]-0.25]}), with total cost 7.0
	Total score: 3062.9705803060006 computed in 0.168 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 3062.9701803060007 computed in 0.045 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 3062.9702803060004 computed in 0.046 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3074.9699603048 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_255]1.92]}), with total cost 10.0
	Total score: 3074.9710003 computed in 0.064 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.173 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9705003 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.263]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.173 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_222]0.601]}), with total cost 9.0
	Total score: 3074.9712602892 computed in 0.045 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_3]0.455]}), with total cost 4.0
	Total score: 3078.9705202939995 computed in 0.062 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_43]0.468]}), with total cost 7.0
	Total score: 3082.9705802987996 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_62]0.602]}), with total cost 7.0
	Total score: 3074.9710602892 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_16]1.88]}), with total cost 6.0
	Total score: 3074.9709602892 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3074.9706602892 computed in 0.039 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 3197.964800439497 computed in 0.070 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.487]}), with total cost 3.0
	Total score: 3158.966460410998 computed in 0.160 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.568]}), with total cost 4.0
	Total score: 3158.9669203875987 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_91]-0.502]}), with total cost 8.0
	Total score: 3281.95712091558 computed in 0.075 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3038.9699603038976 computed in 0.029 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3086.9706903020997 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_254]0.219]}), with total cost 9.0
	Total score: 3098.9709003 computed in 0.176 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3056.9702003000007 computed in 0.047 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3122.969100312 computed in 0.077 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3122.969200312 computed in 0.091 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3326.9546010019785 computed in 0.194 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3062.969960308401 computed in 0.042 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 3062.9705803060006 computed in 0.047 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_127]-0.713]}), with total cost 9.0
	Total score: 3074.9712602892 computed in 0.044 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_255]-0.715]}), with total cost 10.0
	Total score: 3074.9713602892 computed in 0.053 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 63.03020000239987 computed in 0.049 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_51]-0.25]}), with total cost 7.0
	Total score: 87.03069999999988 computed in 0.056 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 87.03029999999988 computed in 0.063 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 87.03039999999989 computed in 0.203 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.105 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_255]1.92]}), with total cost 10.0
	Total score: 3074.9713602892 computed in 0.044 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.061 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9703003 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9705003 computed in 0.189 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.263]}), with total cost 2.0
	Total score: 3074.9699603048 computed in 0.054 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_222]0.601]}), with total cost 9.0
	Total score: 3074.9709003 computed in 0.065 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_3]0.455]}), with total cost 4.0
	Total score: 3090.9705602967997 computed in 0.192 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_43]0.468]}), with total cost 7.0
	Total score: 3082.9710202936003 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_62]0.602]}), with total cost 7.0
	Total score: 3074.9707003 computed in 0.067 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_16]1.88]}), with total cost 6.0
	Total score: 3074.9706002964 computed in 0.078 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3074.9703002964 computed in 0.223 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.067 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.487]}), with total cost 3.0
	Total score: 3242.963100479997 computed in 0.104 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.568]}), with total cost 4.0
	Total score: 3242.963200479997 computed in 0.120 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_91]-0.502]}), with total cost 8.0
	Total score: 3326.9567608183875 computed in 0.104 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3038.9699603038976 computed in 0.039 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.197 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3056.9702003000007 computed in 0.048 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3098.9709003 computed in 0.060 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_254]0.219]}), with total cost 9.0
	Total score: 3086.9706903020997 computed in 0.046 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3098.9702002999998 computed in 0.063 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3107.9693003134994 computed in 0.222 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3122.9689803168 computed in 0.052 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3122.9683903482987 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3284.9572409011816 computed in 0.091 seconds
Evaluating predicates: frozenset({active0}), with total cost 1.0
	Total score: 39.030119793941594 computed in 0.080 seconds
Evaluating predicates: frozenset({gripper_adjacent0}), with total cost 1.0
	Total score: 3090.9699403048 computed in 0.079 seconds
Evaluating predicates: frozenset({gripper_adjacent1}), with total cost 1.0
	Total score: 63.0096123582716 computed in 0.312 seconds
Evaluating predicates: frozenset({gripper_contact1}), with total cost 1.0
	Total score: 32.99959220717615 computed in 0.066 seconds
Evaluating predicates: frozenset({gripper_far0}), with total cost 1.0
	Total score: 1091.0103401047998 computed in 0.241 seconds
Evaluating predicates: frozenset({gripper_far1}), with total cost 1.0
	Total score: 3899.8428195948927 computed in 0.546 seconds
Evaluating predicates: frozenset({gripper_near0}), with total cost 1.0
	Total score: 3090.9699403048 computed in 0.079 seconds
Evaluating predicates: frozenset({gripper_near1}), with total cost 1.0
	Total score: 63.0096123582716 computed in 0.317 seconds
Evaluating predicates: frozenset({gripper_not_touching0}), with total cost 1.0
	Total score: 3074.9698603048005 computed in 0.050 seconds
Evaluating predicates: frozenset({gripper_not_touching1}), with total cost 1.0
	Total score: 4892.2743821192325 computed in 0.576 seconds
Evaluating predicates: frozenset({inactive0}), with total cost 1.0
	Total score: 4028.9673803382 computed in 0.679 seconds
Evaluating predicates: frozenset({kettle_off0}), with total cost 1.0
	Total score: 3230.9689503173004 computed in 0.116 seconds
Evaluating predicates: frozenset({kettle_on0}), with total cost 1.0
	Total score: 3090.9699403048 computed in 0.223 seconds
Evaluating predicates: frozenset({kettle_positioned0}), with total cost 1.0
	Total score: 3062.969860308401 computed in 0.044 seconds
Evaluating predicates: frozenset({not_turned0}), with total cost 1.0
	Total score: 5012.958550415499 computed in 0.210 seconds
Evaluating predicates: frozenset({off0}), with total cost 1.0
	Total score: 4028.9673803382 computed in 0.686 seconds
Evaluating predicates: frozenset({on0}), with total cost 1.0
	Total score: 3090.9705802972003 computed in 0.066 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({gripper_contact1}) with heuristic 32.99959220717615

Hill climbing summary:
	On step 1, added gripper_contact1, with heuristic 33.000 (an improvement of 3065.970 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 119 candidates:
	gripper_contact1
Evaluating predicates: frozenset({gripper_contact1}), with total cost 1.0
	Total score: 32.99959220717615 computed in 0.066 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:gripper, ?x1:knob]
    Preconditions: []
    Add Effects: [gripper_contact1(?x1:knob)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x0:gripper, ?x1:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:kettle, ?x3:knob]
    Preconditions: [KnobAndBurnerLinked(?x3:knob, ?x0:surface), gripper_contact1(?x3:knob)]
    Add Effects: [KettleBoiling(?x2:kettle, ?x0:surface, ?x3:knob)]
    Delete Effects: [gripper_contact1(?x3:knob)]
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x1:gripper, ?x2:kettle, ?x0:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 9 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 12 datapoints (3 positive)
Reduced dataset size from 12 to 6
Loss: 0.69292, iter: 0/10000
Loss: 0.00358, iter: 1000/10000
Loss: 0.00053, iter: 2000/10000
Loss: 0.00017, iter: 3000/10000
Loss: 0.00007, iter: 4000/10000
Loss: 0.00003, iter: 5000/10000
Loss: 0.00002, iter: 6000/10000
Loss: 0.00001, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.05346, iter: 0/1000
Loss: -6.18643, iter: 1000/1000
Loaded best model with loss: -6.35090

Learning neural sampler for NSRT Op1
Generated 3 positive and 45 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 48 datapoints (3 positive)
Reduced dataset size from 48 to 6
Loss: 0.69743, iter: 0/10000
Loss: 0.00051, iter: 1000/10000
Loss: 0.00010, iter: 2000/10000
Loss: 0.00003, iter: 3000/10000
Loss: 0.00002, iter: 4000/10000
Loss: 0.00001, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: 0.02273, iter: 0/1000
Loss: -5.73176, iter: 1000/1000
Loaded best model with loss: -5.94855

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:gripper, ?x1:knob]
    Preconditions: []
    Add Effects: [gripper_contact1(?x1:knob)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x0:gripper, ?x1:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:kettle, ?x3:knob]
    Preconditions: [KnobAndBurnerLinked(?x3:knob, ?x0:surface), gripper_contact1(?x3:knob)]
    Add Effects: [KettleBoiling(?x2:kettle, ?x0:surface, ?x3:knob)]
    Delete Effects: [gripper_contact1(?x3:knob)]
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x1:gripper, ?x2:kettle, ?x0:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Task 1 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Task 2 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 3 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 4 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 5 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 6 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 7 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Task 8 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 9 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
[CogMan] Reset called.
Task 10 / 10: Approach failed at policy execution time with error: NSRT plan exhausted.
Tasks solved: 0 / 10
Average time for successes: inf seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 0, 'num_total': 10, 'avg_suc_time': inf, 'avg_ref_cost': inf, 'min_num_samples': 0.0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 1.0, 'max_skeletons_optimized': 1.0, 'num_solve_timeouts': 0, 'num_solve_failures': 0, 'num_execution_timeouts': 0, 'num_execution_failures': 10, 'avg_num_samples': 0.0, 'avg_num_skeletons_optimized': 1.0, 'avg_num_nodes_expanded': 2.0, 'avg_num_nodes_created': 9.0, 'avg_num_nsrts': 2.0, 'avg_num_preds': 3.0, 'avg_plan_length': 0.0, 'avg_num_failures_discovered': 0.0, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 39.00136109394953, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 238})
Wrote out test results to results/kitchen__grammar_search_invention__3__all____kitchen_boil_kettle-ours__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 250.12611 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_diverse --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only False --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 4
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7f4bfbfc6e60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_diverse', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=False, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7f4bfbfc6ef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=4, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
at
located
holding
off
inactive
turned
gripping
not_at
rotated
not_turned
positioned
removed
not_on
active
released
on
placed
not_gripping
VLM proposed a total of 119 atoms.
Of these, 44 were valid and unique.
For the 18 predicates, there were 88 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.262) 2.0
NOT-((0:kettle).x<=[idx 0]-0.262) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.324) 2.0
NOT-((0:knob).angle<=[idx 0]-0.324) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:knob).angle<=[idx 1]-0.487) 3.0
NOT-((0:knob).angle<=[idx 1]-0.487) 3.0
((0:kettle).z<=[idx 2]1.88) 3.0
Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-((0:kettle).z<=[idx 2]1.88) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:kettle).y<=[idx 3]0.432) 4.0
Forall[0:kettle].[((0:kettle).y<=[idx 3]0.432)(0)] 5.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 3]0.432)(0)] 5.0
NOT-((0:kettle).y<=[idx 3]0.432) 4.0
((0:knob).angle<=[idx 3]-0.568) 4.0
NOT-((0:knob).angle<=[idx 3]-0.568) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:gripper).x<=[idx 11]-0.245) 5.0
Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-((0:gripper).x<=[idx 11]-0.245) 5.0
((0:gripper).y<=[idx 13]0.546) 5.0
Forall[0:gripper].[((0:gripper).y<=[idx 13]0.546)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 13]0.546)(0)] 6.0
NOT-((0:gripper).y<=[idx 13]0.546) 5.0
((0:kettle).x<=[idx 30]-0.254) 6.0
Forall[0:kettle].[((0:kettle).x<=[idx 30]-0.254)(0)] 7.0
NOT-Forall[0:kettle].[((0:kettle).x<=[idx 30]-0.254)(0)] 7.0
NOT-((0:kettle).x<=[idx 30]-0.254) 6.0
((0:kettle).y<=[idx 62]0.603) 7.0
Forall[0:kettle].[((0:kettle).y<=[idx 62]0.603)(0)] 8.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 62]0.603)(0)] 8.0
NOT-((0:kettle).y<=[idx 62]0.603) 7.0
((0:knob).angle<=[idx 91]-0.502) 8.0
NOT-((0:knob).angle<=[idx 91]-0.502) 8.0
((0:surface).z<=[idx 98]1.6) 8.0
NOT-((0:surface).z<=[idx 98]1.6) 8.0
((0:gripper).qw<=[idx 107]0.116) 8.0
Forall[0:gripper].[((0:gripper).qw<=[idx 107]0.116)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 107]0.116)(0)] 9.0
NOT-((0:gripper).qw<=[idx 107]0.116) 8.0
((0:gripper).z<=[idx 127]1.92) 9.0
Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-((0:gripper).z<=[idx 127]1.92) 9.0
((0:gripper).qx<=[idx 127]-0.716) 9.0
NOT-((0:gripper).qx<=[idx 127]-0.716) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
((0:gripper).qw<=[idx 171]0.113) 9.0
Forall[0:gripper].[((0:gripper).qw<=[idx 171]0.113)(0)] 10.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 171]0.113)(0)] 10.0
NOT-((0:gripper).qw<=[idx 171]0.113) 9.0
((0:surface).x<=[idx 254]0.219) 9.0
NOT-((0:surface).x<=[idx 254]0.219) 9.0
((0:gripper).z<=[idx 255]1.92) 10.0
Forall[0:gripper].[((0:gripper).z<=[idx 255]1.92)(0)] 11.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 255]1.92)(0)] 11.0
NOT-((0:gripper).z<=[idx 255]1.92) 10.0
((0:kettle).y<=[idx 255]0.408) 10.0
Forall[0:kettle].[((0:kettle).y<=[idx 255]0.408)(0)] 11.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3098.9697603048 computed in 0.054 seconds


Starting hill climbing at state frozenset() with heuristic 3098.9697603048
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3086.9697003083998 computed in 0.041 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_107]0.116][0]]}), with total cost 9.0
	Total score: 3098.9700603143992 computed in 0.051 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_171]0.113][0]]}), with total cost 10.0
	Total score: 3098.9701603143994 computed in 0.050 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 39.0307799999999 computed in 0.049 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 51.03095999999989 computed in 0.058 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_13]0.546][0]]}), with total cost 6.0
	Total score: 51.03095999999989 computed in 0.056 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 51.03075999999989 computed in 0.055 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.170 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3146.9692003252 computed in 0.038 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_255]1.92][0]]}), with total cost 11.0
	Total score: 3146.9693003251996 computed in 0.039 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.069 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_30]-0.254][0]]}), with total cost 7.0
	Total score: 3146.9685403323997 computed in 0.068 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_255]0.408][0]]}), with total cost 11.0
	Total score: 3114.970300312399 computed in 0.167 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_3]0.432][0]]}), with total cost 5.0
	Total score: 3130.9691403199995 computed in 0.087 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.603][0]]}), with total cost 8.0
	Total score: 3110.9693603252 computed in 0.091 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3146.9682403323995 computed in 0.082 seconds
Evaluating predicates: frozenset({KettleBoiling}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.173 seconds
Evaluating predicates: frozenset({KnobAndBurnerLinked}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.060 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 39.0307799999999 computed in 0.080 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_107]0.116][0]]}), with total cost 9.0
	Total score: 51.03125999999989 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_171]0.113][0]]}), with total cost 10.0
	Total score: 51.031359999999886 computed in 0.182 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3086.9697003083998 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 3098.969760314399 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_13]0.546][0]]}), with total cost 6.0
	Total score: 3098.969760314399 computed in 0.058 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 3098.969560314399 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3074.9700603024 computed in 0.172 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3110.9695603252003 computed in 0.063 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_255]1.92][0]]}), with total cost 11.0
	Total score: 3110.9696603252 computed in 0.059 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_30]-0.254][0]]}), with total cost 7.0
	Total score: 3146.9689003251997 computed in 0.038 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_3]0.432][0]]}), with total cost 5.0
	Total score: 3106.96974031 computed in 0.179 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.603][0]]}), with total cost 8.0
	Total score: 3146.9690003251994 computed in 0.048 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 3146.9686003251995 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 39.0306799999999 computed in 0.081 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_107]0.116]}), with total cost 8.0
	Total score: 51.031159999999886 computed in 0.068 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_171]0.113]}), with total cost 9.0
	Total score: 51.03125999999989 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_127]-0.716]}), with total cost 9.0
	Total score: 3146.9687403323996 computed in 0.183 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3086.9696003083995 computed in 0.044 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 3098.9696603143993 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_13]0.546]}), with total cost 5.0
	Total score: 3098.9696603143993 computed in 0.050 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 3098.9694603143994 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3074.9699603023996 computed in 0.051 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_127]1.92]}), with total cost 9.0
	Total score: 3110.9694603252 computed in 0.174 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_255]1.92]}), with total cost 10.0
	Total score: 3110.9695603252003 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.064 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9702603048 computed in 0.173 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.063 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_30]-0.254]}), with total cost 6.0
	Total score: 3146.9688003251995 computed in 0.053 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_3]0.432]}), with total cost 4.0
	Total score: 3106.9696403099997 computed in 0.101 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_62]0.603]}), with total cost 7.0
	Total score: 3146.9689003251997 computed in 0.169 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3146.9685003252 computed in 0.042 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.324]}), with total cost 2.0
	Total score: 3152.9670503764987 computed in 0.068 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.487]}), with total cost 3.0
	Total score: 3140.9671803779993 computed in 0.043 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.568]}), with total cost 4.0
	Total score: 3158.966560399598 computed in 0.057 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_91]-0.502]}), with total cost 8.0
	Total score: 3218.96279064769 computed in 0.078 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.062 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3038.9699603038976 computed in 0.028 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.056 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3086.9706903020997 computed in 0.161 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_254]0.219]}), with total cost 9.0
	Total score: 3098.9706603048 computed in 0.054 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3056.9698403054003 computed in 0.048 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.061 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3242.963100479997 computed in 0.085 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3242.963200479997 computed in 0.232 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3326.9535210775757 computed in 0.072 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3086.9696003083995 computed in 0.042 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_107]0.116]}), with total cost 8.0
	Total score: 3098.969960314399 computed in 0.050 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_171]0.113]}), with total cost 9.0
	Total score: 3098.9700603143992 computed in 0.049 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_127]-0.716]}), with total cost 9.0
	Total score: 3146.9691003251996 computed in 0.038 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 39.0306799999999 computed in 0.048 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 51.03085999999989 computed in 0.187 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_13]0.546]}), with total cost 5.0
	Total score: 51.03085999999989 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 51.03065999999989 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.062 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_127]1.92]}), with total cost 9.0
	Total score: 3146.9691003251996 computed in 0.051 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_255]1.92]}), with total cost 10.0
	Total score: 3146.9692003252 computed in 0.172 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3098.9700603048 computed in 0.056 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3098.9702603048 computed in 0.055 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.054 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 3074.9699603023996 computed in 0.049 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_30]-0.254]}), with total cost 6.0
	Total score: 3146.9684403323995 computed in 0.196 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_255]0.408]}), with total cost 10.0
	Total score: 3114.9702003123994 computed in 0.063 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_3]0.432]}), with total cost 4.0
	Total score: 3130.9690403199993 computed in 0.068 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_62]0.603]}), with total cost 7.0
	Total score: 3110.9692603252 computed in 0.060 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 3146.9681403324 computed in 0.189 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.324]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.058 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.487]}), with total cost 3.0
	Total score: 3182.9655004259976 computed in 0.080 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.568]}), with total cost 4.0
	Total score: 3182.9656004259973 computed in 0.095 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_91]-0.502]}), with total cost 8.0
	Total score: 3218.9632406131914 computed in 0.070 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3038.9699603038976 computed in 0.032 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.204 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3056.9698403054003 computed in 0.057 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3098.9706603048 computed in 0.066 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_254]0.219]}), with total cost 9.0
	Total score: 3086.9706903020997 computed in 0.050 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3098.9699603047998 computed in 0.066 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3197.964800434998 computed in 0.070 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3146.966940387899 computed in 0.051 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3161.9668303872986 computed in 0.197 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3284.957240904181 computed in 0.097 seconds
Evaluating predicates: frozenset({active0}), with total cost 1.0
	Total score: 3146.9686603191994 computed in 0.071 seconds
Evaluating predicates: frozenset({inactive0}), with total cost 1.0
	Total score: 5923.514326399346 computed in 1.037 seconds
Evaluating predicates: frozenset({not_turned0}), with total cost 1.0
	Total score: 4908.279629242984 computed in 0.875 seconds
Evaluating predicates: frozenset({off0}), with total cost 1.0
	Total score: 5923.514326399346 computed in 1.127 seconds
Evaluating predicates: frozenset({on0}), with total cost 1.0
	Total score: 3146.9686603191994 computed in 0.221 seconds
Evaluating predicates: frozenset({rotated0}), with total cost 1.0
	Total score: 3386.9671303297005 computed in 0.230 seconds
Evaluating predicates: frozenset({turned0}), with total cost 1.0
	Total score: 3386.9671303297005 computed in 0.413 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}) with heuristic 39.030199999999866

Hill climbing summary:
	On step 1, added NOT-[[0:surface].z<=[idx_0]1.6], with heuristic 39.030 (an improvement of 3059.940 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 109 candidates:
	NOT-[[0:surface].z<=[idx_0]1.6]
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 39.030199999999866 computed in 0.101 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 36 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 39 datapoints (3 positive)
Reduced dataset size from 39 to 6
Loss: 0.69495, iter: 0/10000
Loss: 0.00026, iter: 1000/10000
Loss: 0.00004, iter: 2000/10000
Loss: 0.00001, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.04566, iter: 0/1000
Loss: -6.70833, iter: 1000/1000
Loaded best model with loss: -6.70833

Learning neural sampler for NSRT Op1
Generated 3 positive and 189 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 192 datapoints (3 positive)
Reduced dataset size from 192 to 6
Loss: 0.69590, iter: 0/10000
Loss: 0.00036, iter: 1000/10000
Loss: 0.00007, iter: 2000/10000
Loss: 0.00003, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00001, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.01855, iter: 0/1000
Loss: -5.72954, iter: 1000/1000
Loaded best model with loss: -6.09703

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 1 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 2 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 3 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 4 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 5 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 6 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 7 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 8 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 9 / 10: SOLVED
[CogMan] Reset called.
[CogMan] Finishing episode.
Task 10 / 10: SOLVED
Tasks solved: 10 / 10
Average time for successes: 0.16646 seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 10, 'num_total': 10, 'avg_suc_time': 0.16645664642564953, 'avg_ref_cost': 15.74, 'min_num_samples': 0.0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 1.0, 'max_skeletons_optimized': 1.0, 'num_solve_timeouts': 0, 'num_solve_failures': 0, 'num_execution_timeouts': 0, 'num_execution_failures': 0, 'avg_num_samples': 0.0, 'avg_num_skeletons_optimized': 1.0, 'avg_num_nodes_expanded': 2.0, 'avg_num_nodes_created': 12.0, 'avg_num_nsrts': 2.0, 'avg_num_preds': 3.0, 'avg_plan_length': 0.0, 'avg_num_failures_discovered': 0.0, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 38.86292930878699, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 218})
Wrote out test results to results/kitchen__grammar_search_invention__4__all____kitchen_boil_kettle-ours__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 236.03381 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours-vlm-subselection --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_specific --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only True --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 0
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7fa925cd6e60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_specific', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=True, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7fa925cd6ef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=0, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours-vlm-subselection', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
on
holding
off
connected
not_on
burner_off
burner_on
not_holding
VLM proposed a total of 34 atoms.
Of these, 21 were valid and unique.
For the 8 predicates, there were 57 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.261) 2.0
Forall[0:kettle].[((0:kettle).x<=[idx 0]-0.261)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).x<=[idx 0]-0.261)(0)] 3.0
NOT-((0:kettle).x<=[idx 0]-0.261) 2.0
((0:kettle).y<=[idx 0]0.501) 2.0
Forall[0:kettle].[((0:kettle).y<=[idx 0]0.501)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 0]0.501)(0)] 3.0
NOT-((0:kettle).y<=[idx 0]0.501) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.326) 2.0
NOT-((0:knob).angle<=[idx 0]-0.326) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:kettle).x<=[idx 1]-0.265) 3.0
NOT-((0:kettle).x<=[idx 1]-0.265) 3.0
((0:kettle).y<=[idx 1]0.451) 3.0
Forall[0:kettle].[((0:kettle).y<=[idx 1]0.451)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 1]0.451)(0)] 4.0
NOT-((0:kettle).y<=[idx 1]0.451) 3.0
((0:knob).angle<=[idx 1]-0.489) 3.0
NOT-((0:knob).angle<=[idx 1]-0.489) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:gripper).y<=[idx 3]0.541) 4.0
Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-((0:gripper).y<=[idx 3]0.541) 4.0
((0:knob).angle<=[idx 3]-0.57) 4.0
NOT-((0:knob).angle<=[idx 3]-0.57) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:gripper).x<=[idx 11]-0.245) 5.0
Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-((0:gripper).x<=[idx 11]-0.245) 5.0
((0:gripper).qw<=[idx 11]0.103) 5.0
Forall[0:gripper].[((0:gripper).qw<=[idx 11]0.103)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 11]0.103)(0)] 6.0
NOT-((0:gripper).qw<=[idx 11]0.103) 5.0
((0:gripper).x<=[idx 19]-0.254) 6.0
Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-((0:gripper).x<=[idx 19]-0.254) 6.0
((0:gripper).z<=[idx 31]1.92) 7.0
Forall[0:gripper].[((0:gripper).z<=[idx 31]1.92)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 31]1.92)(0)] 8.0
NOT-((0:gripper).z<=[idx 31]1.92) 7.0
((0:gripper).qx<=[idx 31]-0.704) 7.0
NOT-((0:gripper).qx<=[idx 31]-0.704) 7.0
((0:gripper).z<=[idx 63]1.91) 8.0
Forall[0:gripper].[((0:gripper).z<=[idx 63]1.91)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 63]1.91)(0)] 9.0
NOT-((0:gripper).z<=[idx 63]1.91) 8.0
((0:gripper).qx<=[idx 63]-0.713) 8.0
NOT-((0:gripper).qx<=[idx 63]-0.713) 8.0
((0:gripper).y<=[idx 67]0.542) 8.0
Forall[0:gripper].[((0:gripper).y<=[idx 67]0.542)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 67]0.542)(0)] 9.0
NOT-((0:gripper).y<=[idx 67]0.542) 8.0
((0:knob).angle<=[idx 91]-0.504) 8.0
NOT-((0:knob).angle<=[idx 91]-0.504) 8.0
((0:surface).z<=[idx 98]1.6) 8.0
NOT-((0:surface).z<=[idx 98]1.6) 8.0
((0:knob).angle<=[idx 127]-0.649) 9.0
NOT-((0:knob).angle<=[idx 127]-0.649) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3290.9686003153997 computed in 50.406 seconds


Starting hill climbing at state frozenset() with heuristic 3290.9686003153997
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3190.969480308599 computed in 54.487 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]]}), with total cost 6.0
	Total score: 3190.9710202958004 computed in 52.904 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 237.0304800057999 computed in 53.604 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 238.03078000109988 computed in 50.935 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 256.0308800057998 computed in 52.315 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 238.03068000109988 computed in 50.728 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]]}), with total cost 9.0
	Total score: 238.0310800010999 computed in 52.121 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 51.312 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]]}), with total cost 8.0
	Total score: 3410.9676603371004 computed in 50.933 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]]}), with total cost 9.0
	Total score: 3272.969570315301 computed in 50.163 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 51.708 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]]}), with total cost 3.0
	Total score: 3258.9689003166 computed in 52.283 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]]}), with total cost 3.0
	Total score: 2170.979260830304 computed in 52.219 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]]}), with total cost 4.0
	Total score: 3289.9697503099005 computed in 50.805 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3426.9670503342004 computed in 52.664 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 237.0304800057999 computed in 52.526 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]]}), with total cost 6.0
	Total score: 256.03078000579984 computed in 52.328 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3190.969480308599 computed in 54.295 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 3190.9699503162997 computed in 52.759 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 3190.9711202958006 computed in 54.453 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 3190.9698503163 computed in 53.704 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]]}), with total cost 9.0
	Total score: 3190.9702503163 computed in 55.349 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3264.9690203155997 computed in 52.215 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]]}), with total cost 8.0
	Total score: 3340.9684803269997 computed in 52.053 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]]}), with total cost 9.0
	Total score: 3272.969570315301 computed in 54.885 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 54.101 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]]}), with total cost 3.0
	Total score: 3272.9689703153012 computed in 51.012 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]]}), with total cost 3.0
	Total score: 3296.9686403175006 computed in 52.764 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]]}), with total cost 4.0
	Total score: 2366.987780229899 computed in 52.773 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3410.9671603371007 computed in 52.136 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 237.03038000579988 computed in 51.478 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_11]0.103]}), with total cost 5.0
	Total score: 256.0306800057998 computed in 55.338 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_31]-0.704]}), with total cost 7.0
	Total score: 3258.9693003166 computed in 53.183 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_63]-0.713]}), with total cost 8.0
	Total score: 3426.9675503342 computed in 53.894 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3190.969380308599 computed in 54.362 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 3190.9698503163 computed in 55.596 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 3190.9710202958004 computed in 52.720 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 3190.9697503162997 computed in 55.291 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_67]0.542]}), with total cost 8.0
	Total score: 3190.9701503162996 computed in 55.144 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3264.9689203155995 computed in 52.772 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_31]1.92]}), with total cost 7.0
	Total score: 3340.968380327 computed in 53.313 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.91]}), with total cost 8.0
	Total score: 3272.969470315301 computed in 50.983 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3290.9688003153997 computed in 51.834 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 50.031 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3290.9691003154 computed in 51.565 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3290.9688003153997 computed in 50.044 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.261]}), with total cost 2.0
	Total score: 3272.968870315301 computed in 50.487 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_1]-0.265]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 51.017 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_0]0.501]}), with total cost 2.0
	Total score: 3296.9685403175004 computed in 50.370 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_1]0.451]}), with total cost 3.0
	Total score: 2385.987680229899 computed in 50.741 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3410.9670603371005 computed in 51.784 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.326]}), with total cost 2.0
	Total score: 3404.9591605759965 computed in 60.023 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_127]-0.649]}), with total cost 9.0
	Total score: 3359.9631104827977 computed in 58.630 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.489]}), with total cost 3.0
	Total score: 3417.958740592396 computed in 58.426 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.57]}), with total cost 4.0
	Total score: 3342.9625204901977 computed in 57.000 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_91]-0.504]}), with total cost 8.0
	Total score: 3442.9586506011956 computed in 58.695 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3207.9686703218 computed in 54.861 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3160.9691603109995 computed in 53.554 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3207.9686703218 computed in 54.736 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3244.9694803198 computed in 56.846 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3160.9691603109995 computed in 54.153 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 143.03028000059987 computed in 53.222 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3462.9577806003967 computed in 51.474 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3462.9578806003965 computed in 50.922 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3605.9525907457937 computed in 51.340 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3190.969380308599 computed in 56.380 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_11]0.103]}), with total cost 5.0
	Total score: 3190.9709202958006 computed in 53.951 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_31]-0.704]}), with total cost 7.0
	Total score: 3272.969370315301 computed in 51.773 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_63]-0.713]}), with total cost 8.0
	Total score: 3410.9676603371004 computed in 51.725 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 237.03038000579988 computed in 52.924 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 238.03068000109988 computed in 51.720 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 256.03078000579984 computed in 52.991 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 238.0305800010999 computed in 54.200 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_67]0.542]}), with total cost 8.0
	Total score: 238.0309800010999 computed in 53.449 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3290.9688003153997 computed in 50.643 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_31]1.92]}), with total cost 7.0
	Total score: 3410.9675603371006 computed in 50.389 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.91]}), with total cost 8.0
	Total score: 3272.969470315301 computed in 52.932 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3290.9688003153997 computed in 50.838 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3290.9689003154 computed in 51.176 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3290.9691003154 computed in 52.668 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3290.9688003153997 computed in 51.459 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.261]}), with total cost 2.0
	Total score: 3258.9688003165998 computed in 51.074 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_1]-0.265]}), with total cost 3.0
	Total score: 3264.9690203155997 computed in 50.923 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_0]0.501]}), with total cost 2.0
	Total score: 2213.978572862794 computed in 53.563 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_1]0.451]}), with total cost 3.0
	Total score: 3289.9696503099008 computed in 51.201 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3426.9669503342 computed in 52.689 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.326]}), with total cost 2.0
	Total score: 143.03028000059987 computed in 54.035 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_127]-0.649]}), with total cost 9.0
	Total score: 3359.9631104881973 computed in 52.755 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.489]}), with total cost 3.0
	Total score: 3554.9542606859945 computed in 51.214 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.57]}), with total cost 4.0
	Total score: 3554.9543606859943 computed in 51.630 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_91]-0.504]}), with total cost 8.0
	Total score: 3443.9586106084953 computed in 50.882 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3076.9698703035 computed in 56.067 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3114.9696603059997 computed in 54.451 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3076.9698703035 computed in 54.279 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3202.9700203126 computed in 53.467 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3114.9696603059997 computed in 55.909 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3308.9635904615984 computed in 60.280 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 3453.957660612195 computed in 57.865 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 3485.956120658595 computed in 56.981 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_98]1.6]}), with total cost 8.0
	Total score: 3533.955130692494 computed in 58.624 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}) with heuristic 143.03028000059987
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 101.03066000039989 computed in 57.074 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 108.03096000039986 computed in 56.873 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 55.275 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 140.03090000139986 computed in 55.057 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 140.03100000139986 computed in 54.175 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 140.03080000139985 computed in 54.563 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 140.03120000139987 computed in 55.665 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 52.376 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 55.083 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 140.03120000139987 computed in 52.792 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 53.329 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 140.03060000139985 computed in 54.341 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 93.03055989901229 computed in 55.184 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 146.03068000059986 computed in 55.588 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 140.03060000139985 computed in 53.829 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 55.853 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_11]0.103][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 140.03090000139986 computed in 54.338 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 101.03066000039989 computed in 56.364 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 108.03096000039986 computed in 56.956 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 108.03106000039986 computed in 58.272 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 108.03086000039985 computed in 55.232 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_67]0.542][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 108.03126000039985 computed in 56.080 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 55.951 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_31]1.92][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 56.096 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_63]1.91][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 140.03120000139987 computed in 55.320 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 54.887 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_0]-0.261][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 140.03060000139985 computed in 53.276 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.501][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 140.03059000099984 computed in 54.043 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.451][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 117.03070000089886 computed in 54.901 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 140.03060000139985 computed in 52.791 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 55.804 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_11]0.103], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 140.03080000139985 computed in 54.768 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_31]-0.704], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 140.03100000139986 computed in 54.936 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_63]-0.713], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 56.200 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 101.03056000039989 computed in 57.442 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 108.03086000039985 computed in 56.615 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_19]-0.254], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 108.03096000039986 computed in 58.661 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 108.03076000039987 computed in 56.446 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_67]0.542], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 108.03116000039986 computed in 56.516 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 56.285 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_31]1.92], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 140.03100000139986 computed in 56.836 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.91], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 55.687 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 53.504 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 54.818 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 143.03078000059986 computed in 53.115 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 54.289 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.261], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 140.03050000139987 computed in 54.347 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_1]-0.265], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 53.819 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_0]0.501], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 140.03049000099986 computed in 53.725 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_1]0.451], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 136.0306000008988 computed in 54.994 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 140.03050000139987 computed in 54.884 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.326], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 127.03040000159986 computed in 60.445 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_127]-0.649], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 140.03120000139987 computed in 60.824 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.489], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 60.435 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.57], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 143.03068000059986 computed in 60.417 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_91]-0.504], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 61.618 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 91.03040000139985 computed in 57.542 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 75.03040000059987 computed in 56.745 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 91.03040000139985 computed in 56.554 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 143.03118000059987 computed in 59.772 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 75.03040000059987 computed in 57.704 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 52.189 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 143.03068000059986 computed in 54.315 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_98]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 54.146 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 101.03056000039989 computed in 58.227 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_11]0.103], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 108.03086000039985 computed in 56.219 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_31]-0.704], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 140.03100000139986 computed in 54.659 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_63]-0.713], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 54.687 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 55.968 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 140.03080000139985 computed in 55.767 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_19]-0.254], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 8.0
	Total score: 140.03090000139986 computed in 55.637 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_3]0.541], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 140.03070000139985 computed in 55.100 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_67]0.542], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 54.888 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 54.556 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_31]1.92], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 9.0
	Total score: 140.03100000139986 computed in 53.416 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.91], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 55.525 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 54.692 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 54.970 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 7.0
	Total score: 143.03078000059986 computed in 54.377 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 54.785 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.261], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 140.03050000139987 computed in 54.154 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_1]-0.265], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 55.960 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_0]0.501], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 136.0304598931322 computed in 53.712 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_1]0.451], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 146.03058000059985 computed in 55.482 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 140.03050000139987 computed in 54.510 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.326], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 143.03048000059988 computed in 55.092 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_127]-0.649], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 140.03120000139987 computed in 54.864 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.489], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 53.713 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.57], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 143.03068000059986 computed in 53.591 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_91]-0.504], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 55.274 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 44.030400001199865 computed in 57.824 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 54.03039999999987 computed in 57.640 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 38.030440000399864 computed in 57.958 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 11.0
	Total score: 110.03110000029987 computed in 55.706 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 48.03046989900392 computed in 59.476 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 127.03040000159986 computed in 62.504 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 5.0
	Total score: 143.03058000059985 computed in 62.191 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 6.0
	Total score: 143.03068000059986 computed in 60.361 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_98]1.6], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 10.0
	Total score: 140.03110000139986 computed in 63.207 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({[[0:surface].x<=[idx_0]-0.002], NOT-[[0:surface].z<=[idx_0]1.6]}) with heuristic 38.030440000399864

Hill climbing summary:
	On step 1, added NOT-[[0:surface].z<=[idx_0]1.6], with heuristic 143.030 (an improvement of 3147.938 over the previous step)
	On step 2, added [[0:surface].x<=[idx_0]-0.002], with heuristic 38.030 (an improvement of 105.000 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 2 predicates out of 100 candidates:
	[[0:surface].x<=[idx_0]-0.002]
	NOT-[[0:surface].z<=[idx_0]1.6]
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002], NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 4.0
	Total score: 38.030440000399864 computed in 57.493 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface), [[0:surface].x<=[idx_0]-0.002](?x0:surface), burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface), burner_on0(?x0:surface), on0(?x0:surface), on4(?x2:knob)]
    Delete Effects: [burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface), [[0:surface].x<=[idx_0]-0.002](?x0:surface), [[0:surface].x<=[idx_0]-0.002](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)
STRIPS-Op2:
    Parameters: [?x0:surface, ?x1:surface, ?x2:surface, ?x3:surface, ?x4:gripper, ?x5:knob, ?x6:knob, ?x7:knob, ?x8:knob]
    Preconditions: [KnobAndBurnerLinked(?x5:knob, ?x0:surface), KnobAndBurnerLinked(?x6:knob, ?x1:surface), KnobAndBurnerLinked(?x7:knob, ?x2:surface), KnobAndBurnerLinked(?x8:knob, ?x3:surface), [[0:surface].x<=[idx_0]-0.002](?x1:surface), [[0:surface].x<=[idx_0]-0.002](?x3:surface), burner_off0(?x0:surface), burner_off0(?x2:surface), burner_off0(?x3:surface), burner_on0(?x1:surface), off0(?x0:surface), off0(?x2:surface), off0(?x3:surface), off4(?x5:knob), off4(?x7:knob), off4(?x8:knob), on0(?x1:surface), on4(?x6:knob)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x3:surface)]
    Delete Effects: [burner_off0(?x0:surface), burner_off0(?x2:surface), burner_off0(?x3:surface), burner_on0(?x1:surface), off0(?x0:surface), off0(?x2:surface), off0(?x3:surface), off4(?x5:knob), off4(?x7:knob), off4(?x8:knob), on0(?x1:surface), on4(?x6:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x4:gripper, ?x8:knob)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 2 positive and 46 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 48 datapoints (2 positive)
Reduced dataset size from 48 to 4
Loss: 0.69465, iter: 0/10000
Loss: 0.00234, iter: 1000/10000
Loss: 0.00026, iter: 2000/10000
Loss: 0.00008, iter: 3000/10000
Loss: 0.00003, iter: 4000/10000
Loss: 0.00002, iter: 5000/10000
Loss: 0.00001, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 2 datapoints
Loss: 0.04240, iter: 0/1000
Loss: -5.76783, iter: 1000/1000
Loaded best model with loss: -6.42364

Learning neural sampler for NSRT Op1
Generated 3 positive and 189 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 192 datapoints (3 positive)
Reduced dataset size from 192 to 6
Loss: 0.69393, iter: 0/10000
Loss: 0.00028, iter: 1000/10000
Loss: 0.00006, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: -0.02622, iter: 0/1000
Loss: -5.77493, iter: 1000/1000
Loaded best model with loss: -6.04239

Learning neural sampler for NSRT Op2
Generated 1 positive and 100000 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 100001 datapoints (1 positive)
Reduced dataset size from 100001 to 2
Loss: 0.69262, iter: 0/10000
Loss: 0.00022, iter: 1000/10000
Loss: 0.00004, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 1 datapoints
Loss: -0.05930, iter: 0/1000
Loss: -5.47061, iter: 1000/1000
Loaded best model with loss: -6.44890

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface), [[0:surface].x<=[idx_0]-0.002](?x0:surface), burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface), burner_on0(?x0:surface), on0(?x0:surface), on4(?x2:knob)]
    Delete Effects: [burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:surface, ?x2:gripper, ?x3:kettle, ?x4:knob]
    Preconditions: [KnobAndBurnerLinked(?x4:knob, ?x1:surface), NOT-[[0:surface].z<=[idx_0]1.6](?x1:surface), [[0:surface].x<=[idx_0]-0.002](?x0:surface), [[0:surface].x<=[idx_0]-0.002](?x1:surface)]
    Add Effects: [KettleBoiling(?x3:kettle, ?x1:surface, ?x4:knob), NOT-[[0:surface].z<=[idx_0]1.6](?x0:surface)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x2:gripper, ?x3:kettle, ?x1:surface)
NSRT-Op2:
    Parameters: [?x0:surface, ?x1:surface, ?x2:surface, ?x3:surface, ?x4:gripper, ?x5:knob, ?x6:knob, ?x7:knob, ?x8:knob]
    Preconditions: [KnobAndBurnerLinked(?x5:knob, ?x0:surface), KnobAndBurnerLinked(?x6:knob, ?x1:surface), KnobAndBurnerLinked(?x7:knob, ?x2:surface), KnobAndBurnerLinked(?x8:knob, ?x3:surface), [[0:surface].x<=[idx_0]-0.002](?x1:surface), [[0:surface].x<=[idx_0]-0.002](?x3:surface), burner_off0(?x0:surface), burner_off0(?x2:surface), burner_off0(?x3:surface), burner_on0(?x1:surface), off0(?x0:surface), off0(?x2:surface), off0(?x3:surface), off4(?x5:knob), off4(?x7:knob), off4(?x8:knob), on0(?x1:surface), on4(?x6:knob)]
    Add Effects: [NOT-[[0:surface].z<=[idx_0]1.6](?x3:surface)]
    Delete Effects: [burner_off0(?x0:surface), burner_off0(?x2:surface), burner_off0(?x3:surface), burner_on0(?x1:surface), off0(?x0:surface), off0(?x2:surface), off0(?x3:surface), off4(?x5:knob), off4(?x7:knob), off4(?x8:knob), on0(?x1:surface), on4(?x6:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x4:gripper, ?x8:knob)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 1 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 2 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 3 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 4 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 5 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 6 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), [[0:surface].x<=[idx_0]-0.002](burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface)}
Task 7 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), [[0:surface].x<=[idx_0]-0.002](burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface)}
Task 8 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 9 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), off4(knob2:knob), [[0:surface].x<=[idx_0]-0.002](burner4:surface), off0(burner4:surface), [[0:surface].x<=[idx_0]-0.002](burner2:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), on0(burner1:surface), on4(knob1:knob)}
Task 10 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
Tasks solved: 0 / 10
Average time for successes: inf seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 0, 'num_total': 10, 'avg_suc_time': inf, 'avg_ref_cost': inf, 'min_num_samples': 0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 0, 'max_skeletons_optimized': 0.0, 'num_solve_timeouts': 0, 'num_solve_failures': 10, 'num_execution_timeouts': 0, 'num_execution_failures': 0, 'avg_num_samples': inf, 'avg_num_skeletons_optimized': inf, 'avg_num_nodes_expanded': inf, 'avg_num_nodes_created': inf, 'avg_num_nsrts': inf, 'avg_num_preds': inf, 'avg_plan_length': inf, 'avg_num_failures_discovered': inf, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 10999.043987815268, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 300})
Wrote out test results to results/kitchen__grammar_search_invention__0__all____kitchen_boil_kettle-ours-vlm-subselection__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 11325.18755 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours-vlm-subselection --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_specific --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only True --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 1
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7fd60894ae60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_specific', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=True, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7fd60894aef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=1, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours-vlm-subselection', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
holding
off
burner_off
connected
not_on
gripper_free
on
burner_on
not_holding
kettle_empty
VLM proposed a total of 29 atoms.
Of these, 21 were valid and unique.
For the 10 predicates, there were 55 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.262) 2.0
NOT-((0:kettle).x<=[idx 0]-0.262) 2.0
((0:kettle).y<=[idx 0]0.51) 2.0
Forall[0:kettle].[((0:kettle).y<=[idx 0]0.51)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 0]0.51)(0)] 3.0
NOT-((0:kettle).y<=[idx 0]0.51) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.325) 2.0
NOT-((0:knob).angle<=[idx 0]-0.325) 2.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:knob).angle<=[idx 1]-0.488) 3.0
NOT-((0:knob).angle<=[idx 1]-0.488) 3.0
((0:kettle).z<=[idx 2]1.88) 3.0
Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 2]1.88)(0)] 4.0
NOT-((0:kettle).z<=[idx 2]1.88) 3.0
((0:surface).z<=[idx 2]1.6) 3.0
NOT-((0:surface).z<=[idx 2]1.6) 3.0
((0:knob).angle<=[idx 3]-0.569) 4.0
NOT-((0:knob).angle<=[idx 3]-0.569) 4.0
((0:surface).z<=[idx 6]1.6) 4.0
NOT-((0:surface).z<=[idx 6]1.6) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:gripper).x<=[idx 11]-0.245) 5.0
Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 11]-0.245)(0)] 6.0
NOT-((0:gripper).x<=[idx 11]-0.245) 5.0
((0:gripper).y<=[idx 15]0.54) 6.0
Forall[0:gripper].[((0:gripper).y<=[idx 15]0.54)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 15]0.54)(0)] 7.0
NOT-((0:gripper).y<=[idx 15]0.54) 6.0
((0:kettle).y<=[idx 15]0.422) 6.0
Forall[0:kettle].[((0:kettle).y<=[idx 15]0.422)(0)] 7.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 15]0.422)(0)] 7.0
NOT-((0:kettle).y<=[idx 15]0.422) 6.0
((0:surface).z<=[idx 18]1.6) 6.0
NOT-((0:surface).z<=[idx 18]1.6) 6.0
((0:gripper).x<=[idx 19]-0.254) 6.0
Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 19]-0.254)(0)] 7.0
NOT-((0:gripper).x<=[idx 19]-0.254) 6.0
((0:knob).angle<=[idx 27]-0.508) 6.0
NOT-((0:knob).angle<=[idx 27]-0.508) 6.0
((0:knob).angle<=[idx 31]-0.64) 7.0
NOT-((0:knob).angle<=[idx 31]-0.64) 7.0
Forall[0:knob].[NOT-((0:knob).angle<=[idx 31]-0.64)(0)] 8.0
NOT-Forall[0:knob].[NOT-((0:knob).angle<=[idx 31]-0.64)(0)] 8.0
((0:kettle).y<=[idx 62]0.601) 7.0
Forall[0:kettle].[((0:kettle).y<=[idx 62]0.601)(0)] 8.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 62]0.601)(0)] 8.0
NOT-((0:kettle).y<=[idx 62]0.601) 7.0
((0:surface).z<=[idx 62]1.6) 7.0
NOT-((0:surface).z<=[idx 62]1.6) 7.0
((0:gripper).z<=[idx 63]1.92) 8.0
NOT-((0:gripper).z<=[idx 63]1.92) 8.0
((0:gripper).qx<=[idx 63]-0.711) 8.0
NOT-((0:gripper).qx<=[idx 63]-0.711) 8.0
((0:knob).angle<=[idx 127]-0.648) 9.0
NOT-((0:knob).angle<=[idx 127]-0.648) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
((0:gripper).qw<=[idx 171]0.113) 9.0
Forall[0:gripper].[((0:gripper).qw<=[idx 171]0.113)(0)] 10.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 102.02999999999986 computed in 46.759 seconds


Starting hill climbing at state frozenset() with heuristic 102.02999999999986
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 96.03029999999985 computed in 47.212 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_171]0.113][0]]}), with total cost 10.0
	Total score: 96.03099999999986 computed in 47.179 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 72.03029999999985 computed in 47.872 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 72.03059999999986 computed in 50.092 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 78.03069999999985 computed in 50.203 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_15]0.54][0]]}), with total cost 7.0
	Total score: 78.03069999999985 computed in 48.928 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 78.03039999999986 computed in 48.818 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 48.356 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 46.306 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.51][0]]}), with total cost 3.0
	Total score: 84.02015062120476 computed in 50.081 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_15]0.422][0]]}), with total cost 7.0
	Total score: 54.01040124240966 computed in 50.510 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.601][0]]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 48.354 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 111.03029999999985 computed in 49.972 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 102.03039999999986 computed in 50.535 seconds
Evaluating predicates: frozenset({Forall[0:knob].[NOT-[[0:knob].angle<=[idx_31]-0.64][0]]}), with total cost 8.0
	Total score: 102.03079999999986 computed in 49.272 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 72.03029999999985 computed in 51.294 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 96.03029999999985 computed in 45.565 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_11]-0.245][0]]}), with total cost 6.0
	Total score: 96.03059999999986 computed in 50.008 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_19]-0.254][0]]}), with total cost 7.0
	Total score: 105.03069999999985 computed in 48.943 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_15]0.54][0]]}), with total cost 7.0
	Total score: 105.03069999999985 computed in 47.444 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 105.03039999999986 computed in 45.577 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 50.184 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 49.916 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_0]0.51][0]]}), with total cost 3.0
	Total score: 105.03029999999985 computed in 46.742 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_15]0.422][0]]}), with total cost 7.0
	Total score: 99.03069999999985 computed in 48.786 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_62]0.601][0]]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 46.980 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 111.03029999999985 computed in 49.700 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_2]1.88][0]]}), with total cost 4.0
	Total score: 102.03039999999986 computed in 48.095 seconds
Evaluating predicates: frozenset({NOT-Forall[0:knob].[NOT-[[0:knob].angle<=[idx_31]-0.64][0]]}), with total cost 8.0
	Total score: 102.03079999999986 computed in 47.538 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 72.03019999999987 computed in 49.765 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_63]-0.711]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 50.573 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 96.03019999999987 computed in 47.582 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 96.03049999999986 computed in 48.794 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 105.03059999999986 computed in 48.898 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_15]0.54]}), with total cost 6.0
	Total score: 105.03059999999986 computed in 47.483 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 105.03029999999985 computed in 47.262 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 50.028 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 48.496 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 47.865 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 45.901 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 102.03049999999986 computed in 47.204 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 47.475 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 48.180 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_0]0.51]}), with total cost 2.0
	Total score: 105.03019999999987 computed in 48.355 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_15]0.422]}), with total cost 6.0
	Total score: 99.03059999999986 computed in 49.057 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_62]0.601]}), with total cost 7.0
	Total score: 111.03069999999985 computed in 46.987 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 111.03019999999987 computed in 48.575 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 48.276 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 78.03019999999987 computed in 54.791 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_127]-0.648]}), with total cost 9.0
	Total score: 117.03089999999986 computed in 52.956 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_1]-0.488]}), with total cost 3.0
	Total score: 108.03029999999985 computed in 57.893 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_27]-0.508]}), with total cost 6.0
	Total score: 108.03059999999986 computed in 57.476 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_31]-0.64]}), with total cost 7.0
	Total score: 108.03069999999985 computed in 52.676 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_3]-0.569]}), with total cost 4.0
	Total score: 108.03039999999986 computed in 57.000 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 87.03019999999985 computed in 48.665 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 27.03019999999986 computed in 49.859 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 87.03019999999985 computed in 51.507 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 45.03089999999986 computed in 53.081 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 27.03019999999986 computed in 49.472 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 48.03019999999986 computed in 49.634 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_18]1.6]}), with total cost 6.0
	Total score: 108.03059999999986 computed in 49.771 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 108.03029999999985 computed in 51.202 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_62]1.6]}), with total cost 7.0
	Total score: 108.03069999999985 computed in 47.752 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 108.03039999999986 computed in 49.022 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 96.03019999999987 computed in 49.184 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_171]0.113]}), with total cost 9.0
	Total score: 96.03089999999986 computed in 46.907 seconds
Evaluating predicates: frozenset({[[0:gripper].qx<=[idx_63]-0.711]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 49.313 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 72.03019999999987 computed in 49.604 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_11]-0.245]}), with total cost 5.0
	Total score: 72.03049999999986 computed in 51.832 seconds
Evaluating predicates: frozenset({[[0:gripper].x<=[idx_19]-0.254]}), with total cost 6.0
	Total score: 78.03059999999986 computed in 50.213 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_15]0.54]}), with total cost 6.0
	Total score: 78.03059999999986 computed in 52.444 seconds
Evaluating predicates: frozenset({[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 78.03029999999985 computed in 48.456 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 49.742 seconds
Evaluating predicates: frozenset({[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 111.03079999999986 computed in 48.456 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 47.068 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 47.348 seconds
Evaluating predicates: frozenset({[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 102.03049999999986 computed in 46.432 seconds
Evaluating predicates: frozenset({[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 48.005 seconds
Evaluating predicates: frozenset({[[0:kettle].x<=[idx_0]-0.262]}), with total cost 2.0
	Total score: 102.03019999999987 computed in 49.895 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_0]0.51]}), with total cost 2.0
	Total score: 84.02005062120477 computed in 50.985 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_15]0.422]}), with total cost 6.0
	Total score: 54.01030124240965 computed in 52.605 seconds
Evaluating predicates: frozenset({[[0:kettle].y<=[idx_62]0.601]}), with total cost 7.0
	Total score: 111.03069999999985 computed in 48.202 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 111.03019999999987 computed in 52.257 seconds
Evaluating predicates: frozenset({[[0:kettle].z<=[idx_2]1.88]}), with total cost 3.0
	Total score: 102.03029999999985 computed in 51.733 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_0]-0.325]}), with total cost 2.0
	Total score: 48.03019999999986 computed in 49.060 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_127]-0.648]}), with total cost 9.0
	Total score: 117.03089999999986 computed in 48.777 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_1]-0.488]}), with total cost 3.0
	Total score: 108.03029999999985 computed in 49.790 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_27]-0.508]}), with total cost 6.0
	Total score: 108.03059999999986 computed in 52.620 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_31]-0.64]}), with total cost 7.0
	Total score: 108.03069999999985 computed in 46.949 seconds
Evaluating predicates: frozenset({[[0:knob].angle<=[idx_3]-0.569]}), with total cost 4.0
	Total score: 108.03039999999986 computed in 49.519 seconds
Evaluating predicates: frozenset({[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 90.03019999999985 computed in 49.311 seconds
Evaluating predicates: frozenset({[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 48.03020000029676 computed in 51.495 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 90.03019999999985 computed in 49.280 seconds
Evaluating predicates: frozenset({[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 78.03089999999986 computed in 49.714 seconds
Evaluating predicates: frozenset({[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 48.03020000029676 computed in 50.105 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 78.03019999999987 computed in 56.568 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_18]1.6]}), with total cost 6.0
	Total score: 108.03059999999986 computed in 58.229 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_2]1.6]}), with total cost 3.0
	Total score: 108.03029999999985 computed in 56.506 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_62]1.6]}), with total cost 7.0
	Total score: 108.03069999999985 computed in 54.189 seconds
Evaluating predicates: frozenset({[[0:surface].z<=[idx_6]1.6]}), with total cost 4.0
	Total score: 108.03039999999986 computed in 56.232 seconds
Found an improvement at depth 0

Hill climbing reached new state frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}) with heuristic 27.03019999999986

Hill climbing summary:
	On step 1, added NOT-[[0:knob].z<=[idx_0]2.28], with heuristic 27.030 (an improvement of 75.000 over the previous step)

Filtering out predicates that don't appear in preconditions...

Selected 1 predicates out of 100 candidates:
	NOT-[[0:knob].z<=[idx_0]2.28]
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 27.03019999999986 computed in 51.114 seconds
Done.

Learning NSRTs on 3 trajectories...

Doing option learning...

Operators with known options:
STRIPS-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x2:knob), burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Add Effects: [burner_on0(?x0:surface), on0(?x2:knob)]
    Delete Effects: [burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
STRIPS-Op1:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:kettle, ?x3:knob]
    Preconditions: [KnobAndBurnerLinked(?x3:knob, ?x0:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x3:knob), burner_on0(?x0:surface), on0(?x3:knob)]
    Add Effects: [KettleBoiling(?x2:kettle, ?x0:surface, ?x3:knob)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x1:gripper, ?x2:kettle, ?x0:surface)
STRIPS-Op2:
    Parameters: [?x0:surface, ?x1:surface, ?x2:surface, ?x3:surface, ?x4:gripper, ?x5:kettle, ?x6:knob, ?x7:knob, ?x8:knob, ?x9:knob]
    Preconditions: [KnobAndBurnerLinked(?x6:knob, ?x0:surface), KnobAndBurnerLinked(?x7:knob, ?x1:surface), KnobAndBurnerLinked(?x8:knob, ?x2:surface), KnobAndBurnerLinked(?x9:knob, ?x3:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x8:knob), NOT-[[0:knob].z<=[idx_0]2.28](?x9:knob), burner_off0(?x0:surface), burner_off0(?x2:surface), burner_on0(?x1:surface), burner_on0(?x3:surface), off0(?x0:surface), off0(?x2:surface), off4(?x6:knob), off4(?x8:knob), on0(?x7:knob), on0(?x9:knob)]
    Add Effects: [KettleBoiling(?x5:kettle, ?x3:surface, ?x9:knob)]
    Delete Effects: [burner_off0(?x0:surface), burner_off0(?x2:surface), burner_on0(?x1:surface), burner_on0(?x3:surface), off0(?x0:surface), off0(?x2:surface), off4(?x6:knob), off4(?x8:knob), on0(?x7:knob), on0(?x9:knob)]
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x4:gripper, ?x5:kettle, ?x3:surface)

Learned operators with option specs:

Doing sampler learning...

Learning neural sampler for NSRT Op0
Generated 3 positive and 45 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 48 datapoints (3 positive)
Reduced dataset size from 48 to 6
Loss: 0.69228, iter: 0/10000
Loss: 0.00086, iter: 1000/10000
Loss: 0.00017, iter: 2000/10000
Loss: 0.00006, iter: 3000/10000
Loss: 0.00003, iter: 4000/10000
Loss: 0.00001, iter: 5000/10000
Loss: 0.00001, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 3 datapoints
Loss: 0.00826, iter: 0/1000
Loss: -6.04083, iter: 1000/1000
Loaded best model with loss: -6.56879

Learning neural sampler for NSRT Op1
Generated 2 positive and 45 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 47 datapoints (2 positive)
Reduced dataset size from 47 to 4
Loss: 0.69254, iter: 0/10000
Loss: 0.00027, iter: 1000/10000
Loss: 0.00005, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 2 datapoints
Loss: -0.04104, iter: 0/1000
Loss: -5.90869, iter: 1000/1000
Loaded best model with loss: -6.18370

Learning neural sampler for NSRT Op2
Generated 1 positive and 100000 negative examples
Fitting classifier...
Training MLPBinaryClassifier on 100001 datapoints (1 positive)
Reduced dataset size from 100001 to 2
Loss: 0.69725, iter: 0/10000
Loss: 0.00022, iter: 1000/10000
Loss: 0.00005, iter: 2000/10000
Loss: 0.00002, iter: 3000/10000
Loss: 0.00001, iter: 4000/10000
Loss: 0.00000, iter: 5000/10000
Loss: 0.00000, iter: 6000/10000
Loss: 0.00000, iter: 7000/10000
Loss: 0.00000, iter: 8000/10000
Loss: 0.00000, iter: 9000/10000
Loss: 0.00000, iter: 10000/10000
Loaded best model with loss: 0.00000
Fitting regressor...
Training NeuralGaussianRegressor on 1 datapoints
Loss: 0.00656, iter: 0/1000
Loss: -5.98867, iter: 1000/1000
Loaded best model with loss: -6.13503

Learned NSRTs:
NSRT-Op0:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:knob]
    Preconditions: [KnobAndBurnerLinked(?x2:knob, ?x0:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x2:knob), burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Add Effects: [burner_on0(?x0:surface), on0(?x2:knob)]
    Delete Effects: [burner_off0(?x0:surface), off0(?x0:surface), off4(?x2:knob)]
    Ignore Effects: []
    Option Spec: MoveAndTurnOnKnob(?x1:gripper, ?x2:knob)
NSRT-Op1:
    Parameters: [?x0:surface, ?x1:gripper, ?x2:kettle, ?x3:knob]
    Preconditions: [KnobAndBurnerLinked(?x3:knob, ?x0:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x3:knob), burner_on0(?x0:surface), on0(?x3:knob)]
    Add Effects: [KettleBoiling(?x2:kettle, ?x0:surface, ?x3:knob)]
    Delete Effects: []
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x1:gripper, ?x2:kettle, ?x0:surface)
NSRT-Op2:
    Parameters: [?x0:surface, ?x1:surface, ?x2:surface, ?x3:surface, ?x4:gripper, ?x5:kettle, ?x6:knob, ?x7:knob, ?x8:knob, ?x9:knob]
    Preconditions: [KnobAndBurnerLinked(?x6:knob, ?x0:surface), KnobAndBurnerLinked(?x7:knob, ?x1:surface), KnobAndBurnerLinked(?x8:knob, ?x2:surface), KnobAndBurnerLinked(?x9:knob, ?x3:surface), NOT-[[0:knob].z<=[idx_0]2.28](?x8:knob), NOT-[[0:knob].z<=[idx_0]2.28](?x9:knob), burner_off0(?x0:surface), burner_off0(?x2:surface), burner_on0(?x1:surface), burner_on0(?x3:surface), off0(?x0:surface), off0(?x2:surface), off4(?x6:knob), off4(?x8:knob), on0(?x7:knob), on0(?x9:knob)]
    Add Effects: [KettleBoiling(?x5:kettle, ?x3:surface, ?x9:knob)]
    Delete Effects: [burner_off0(?x0:surface), burner_off0(?x2:surface), burner_on0(?x1:surface), burner_on0(?x3:surface), off0(?x0:surface), off0(?x2:surface), off4(?x6:knob), off4(?x8:knob), on0(?x7:knob), on0(?x9:knob)]
    Ignore Effects: []
    Option Spec: PushKettleOntoBurner(?x4:gripper, ?x5:kettle, ?x3:surface)

/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off0(burner4:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 1 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off0(burner4:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 2 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off4(knob4:knob), off4(knob3:knob), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 3 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off4(knob4:knob), off4(knob3:knob), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 4 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off0(burner4:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 5 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off0(burner4:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 6 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off4(knob4:knob), off4(knob3:knob), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 7 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off4(knob4:knob), off4(knob3:knob), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 8 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), burner_on0(burner1:surface), burner_off0(burner2:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), off4(knob2:knob), on0(knob1:knob), off0(burner4:surface), burner_off0(burner4:surface), off4(knob4:knob), off0(burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 9 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
[CogMan] Reset called.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Detected goal unreachable. Goal: {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)}
Initial atoms: {KnobAndBurnerLinked(knob1:knob, burner1:surface), KnobAndBurnerLinked(knob3:knob, burner3:surface), KnobAndBurnerLinked(knob4:knob, burner4:surface), KnobAndBurnerLinked(knob2:knob, burner2:surface), NOT-[[0:knob].z<=[idx_0]2.28](knob3:knob), NOT-[[0:knob].z<=[idx_0]2.28](knob4:knob)}
Task 10 / 10: Approach failed to solve with error: Goal {KettleBoiling(kettle:kettle, burner3:surface, knob3:knob)} not dr-reachable
Tasks solved: 0 / 10
Average time for successes: inf seconds
Test results: defaultdict(<class 'float'>, {'num_solved': 0, 'num_total': 10, 'avg_suc_time': inf, 'avg_ref_cost': inf, 'min_num_samples': 0, 'max_num_samples': 0.0, 'min_skeletons_optimized': 0, 'max_skeletons_optimized': 0.0, 'num_solve_timeouts': 0, 'num_solve_failures': 10, 'num_execution_timeouts': 0, 'num_execution_failures': 0, 'avg_num_samples': inf, 'avg_num_skeletons_optimized': inf, 'avg_num_nodes_expanded': inf, 'avg_num_nodes_created': inf, 'avg_num_nsrts': inf, 'avg_num_preds': inf, 'avg_plan_length': inf, 'avg_num_failures_discovered': inf, 'num_offline_transitions': 6, 'num_online_transitions': 0, 'query_cost': 0.0, 'learning_time': 5114.743497028016, 'offline_learning_grammar_size': 100, 'offline_learning_total_num_predicate_evaluations': 200})
Wrote out test results to results/kitchen__grammar_search_invention__1__all____kitchen_boil_kettle-ours-vlm-subselection__None.pkl


ONLINE LEARNING CYCLE 0

Getting interaction requests...
Did not receive any interaction requests, terminating


Main script terminated in 5408.39845 seconds
pybullet build time: Nov 28 2023 23:45:17
Running command: python predicators/main.py --env kitchen --approach grammar_search_invention --experiment_id kitchen_boil_kettle-ours-vlm-subselection --vlm_model_name gpt-4o --num_test_tasks 10 --save_eval_trajs False --grammar_search_vlm_atom_proposal_prompt_type options_labels_whole_traj_specific --offline_data_method geo_and_demo_with_vlm_imgs --grammar_search_invent_geo_predicates_only True --perceiver kitchen --kitchen_goals boil_kettle --kitchen_use_perfect_samplers True --kitchen_render_set_of_marks True --kitchen_use_combo_move_nsrts True --kitchen_randomize_init_state True --bilevel_plan_without_sim True --segmenter option_changes --grammar_search_vlm_atom_label_prompt_type img_option_diffs_label_history --grammar_search_task_planning_timeout 10.0 --sesame_max_skeletons_optimized 200 --disable_harmlessness_check True --excluded_predicates all --grammar_search_vlm_atom_proposal_use_debug False --grammar_search_prune_redundant_preds True --grammar_search_predicate_cost_upper_bound 13 --allow_state_allclose_comparison_despite_simulator_state True --grammar_search_max_predicates 100 --grammar_search_parallelize_vlm_labeling True --grammar_search_use_handcoded_debug_grammar False --grammar_search_select_all_debug False --cluster_and_intersect_soft_intersection_for_preconditions True --grammar_search_grammar_includes_givens False --cluster_and_intersect_prune_low_data_pnads True --cluster_and_intersect_min_datastore_fraction 0.05 --num_train_tasks 3 --precondition_soft_intersection_threshold_percent 0.8 --vlm_double_check_output True --grammar_search_early_termination_heuristic_thresh 100 --seed 2
Full config:
namespace(num_train_tasks=3, num_test_tasks=10, num_online_learning_cycles=10, online_learning_max_transitions=inf, max_initial_demos=inf, allow_interaction_in_demo_tasks=True, max_num_steps_interaction_request=100, pretty_print_when_loading=False, test_env_seed_offset=10000, test_task_json_dir=None, segmenter='option_changes', demonstrator='oracle', render_state_dpi=150, approach_wrapper=None, allow_exclude_goal_predicates=False, allow_state_allclose_comparison_despite_simulator_state=True, cover_multistep_action_limits=[-inf, inf], cover_multistep_degenerate_oracle_samplers=False, cover_multistep_max_tb_placements=100, cover_multistep_max_hr_placements=100, cover_multistep_thr_percent=0.4, cover_multistep_bhr_percent=0.4, cover_multistep_bimodal_goal=False, cover_multistep_goal_conditioned_sampling=False, bumpy_cover_num_bumps=2, bumpy_cover_spaces_per_bump=1, bumpy_cover_right_targets=False, bumpy_cover_bumpy_region_start=0.8, bumpy_cover_init_bumpy_prob=0.25, regional_bumpy_cover_include_impossible_nsrt=False, blocks_num_blocks_train=[3, 4], blocks_num_blocks_test=[5, 6], blocks_holding_goals=False, blocks_block_size=0.045, playroom_num_blocks_train=[3], playroom_num_blocks_test=[3], cluttered_table_num_cans_train=5, cluttered_table_num_cans_test=10, cluttered_table_can_radius=0.01, cluttered_table_collision_angle_thresh=0.7853981633974483, cluttered_table_place_goal_conditioned_sampling=True, repeated_nextto_num_dots=15, repeated_nextto_nextto_thresh=0.5, painting_initial_holding_prob=0.5, painting_lid_open_prob=0.3, painting_num_objs_train=[2, 3], painting_num_objs_test=[3, 4], painting_max_objs_in_goal=inf, painting_goal_receptacles='box_and_shelf', painting_raise_environment_failure=True, rnt_painting_num_objs_train=[8, 9, 10], rnt_painting_num_objs_test=[11, 12, 13], rnt_painting_max_objs_in_goal=2, tools_num_items_train=[2], tools_num_items_test=[2, 3], tools_num_contraptions_train=[2], tools_num_contraptions_test=[3], sandwich_ingredients_train={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, sandwich_ingredients_test={'bread': [2], 'patty': [1], 'ham': [1], 'egg': [1], 'cheese': [1], 'lettuce': [1], 'tomato': [1], 'green_pepper': [1]}, pybullet_draw_debug=False, pybullet_camera_width=335, pybullet_camera_height=180, pybullet_sim_steps_per_action=20, pybullet_max_ik_iters=100, pybullet_ik_tol=0.001, pybullet_robot='fetch', pybullet_birrt_num_attempts=10, pybullet_birrt_num_iters=100, pybullet_birrt_smooth_amt=50, pybullet_birrt_extend_num_interp=10, pybullet_control_mode='position', pybullet_max_vel_norm=0.05, pybullet_robot_ee_orns=defaultdict(<function GlobalSettings.<lambda> at 0x7fc5cd56ee60>, {'pybullet_blocks': {'fetch': (0.7071, 0.0, -0.7071, 0.0), 'panda': (0.7071, 0.7071, 0.0, 0.0)}}), ikfast_max_time=0.05, ikfast_max_candidates=100, ikfast_max_attempts=inf, ikfast_max_distance=inf, ikfast_norm=inf, pddl_blocks_procedural_train_min_num_blocks=3, pddl_blocks_procedural_train_max_num_blocks=4, pddl_blocks_procedural_train_min_num_blocks_goal=2, pddl_blocks_procedural_train_max_num_blocks_goal=3, pddl_blocks_procedural_test_min_num_blocks=5, pddl_blocks_procedural_test_max_num_blocks=6, pddl_blocks_procedural_test_min_num_blocks_goal=2, pddl_blocks_procedural_test_max_num_blocks_goal=5, pddl_blocks_procedural_new_pile_prob=0.5, pddl_blocks_fixed_train_indices=[1, 2, 3, 4, 5], pddl_blocks_fixed_test_indices=[6, 7, 8, 9, 10], pddl_delivery_procedural_train_min_num_locs=5, pddl_delivery_procedural_train_max_num_locs=10, pddl_delivery_procedural_train_min_want_locs=2, pddl_delivery_procedural_train_max_want_locs=4, pddl_delivery_procedural_train_min_extra_newspapers=0, pddl_delivery_procedural_train_max_extra_newspapers=1, pddl_delivery_procedural_test_min_num_locs=31, pddl_delivery_procedural_test_max_num_locs=40, pddl_delivery_procedural_test_min_want_locs=20, pddl_delivery_procedural_test_max_want_locs=30, pddl_delivery_procedural_test_min_extra_newspapers=0, pddl_delivery_procedural_test_max_extra_newspapers=10, pddl_easy_delivery_procedural_train_min_num_locs=3, pddl_easy_delivery_procedural_train_max_num_locs=5, pddl_easy_delivery_procedural_train_min_want_locs=1, pddl_easy_delivery_procedural_train_max_want_locs=2, pddl_easy_delivery_procedural_train_min_extra_newspapers=0, pddl_easy_delivery_procedural_train_max_extra_newspapers=1, pddl_easy_delivery_procedural_test_min_num_locs=4, pddl_easy_delivery_procedural_test_max_num_locs=6, pddl_easy_delivery_procedural_test_min_want_locs=2, pddl_easy_delivery_procedural_test_max_want_locs=3, pddl_easy_delivery_procedural_test_min_extra_newspapers=0, pddl_easy_delivery_procedural_test_max_extra_newspapers=1, pddl_spanner_procedural_train_min_nuts=1, pddl_spanner_procedural_train_max_nuts=3, pddl_spanner_procedural_train_min_extra_spanners=0, pddl_spanner_procedural_train_max_extra_spanners=2, pddl_spanner_procedural_train_min_locs=2, pddl_spanner_procedural_train_max_locs=4, pddl_spanner_procedural_test_min_nuts=10, pddl_spanner_procedural_test_max_nuts=20, pddl_spanner_procedural_test_min_extra_spanners=0, pddl_spanner_procedural_test_max_extra_spanners=10, pddl_spanner_procedural_test_min_locs=20, pddl_spanner_procedural_test_max_locs=30, pddl_forest_procedural_train_min_size=8, pddl_forest_procedural_train_max_size=10, pddl_forest_procedural_test_min_size=10, pddl_forest_procedural_test_max_size=12, pddl_gripper_procedural_train_min_num_rooms=3, pddl_gripper_procedural_train_max_num_rooms=5, pddl_gripper_procedural_train_min_num_balls=1, pddl_gripper_procedural_train_max_num_balls=2, pddl_gripper_procedural_test_min_num_rooms=3, pddl_gripper_procedural_test_max_num_rooms=5, pddl_gripper_procedural_test_min_num_balls=1, pddl_gripper_procedural_test_max_num_balls=2, pddl_ferry_procedural_train_min_num_locs=3, pddl_ferry_procedural_train_max_num_locs=5, pddl_ferry_procedural_train_min_num_cars=1, pddl_ferry_procedural_train_max_num_cars=2, pddl_ferry_procedural_test_min_num_locs=3, pddl_ferry_procedural_test_max_num_locs=5, pddl_ferry_procedural_test_min_num_cars=1, pddl_ferry_procedural_test_max_num_cars=2, pddl_miconic_procedural_train_min_buildings=1, pddl_miconic_procedural_train_max_buildings=2, pddl_miconic_procedural_train_min_floors=3, pddl_miconic_procedural_train_max_floors=5, pddl_miconic_procedural_train_min_passengers=1, pddl_miconic_procedural_train_max_passengers=2, pddl_miconic_procedural_test_min_buildings=1, pddl_miconic_procedural_test_max_buildings=2, pddl_miconic_procedural_test_min_floors=3, pddl_miconic_procedural_test_max_floors=5, pddl_miconic_procedural_test_min_passengers=1, pddl_miconic_procedural_test_max_passengers=2, stick_button_num_buttons_train=[1, 2], stick_button_num_buttons_test=[3, 4], stick_button_disable_angles=True, stick_button_holder_scale=0.1, screws_num_screws_train=[15, 20], screws_num_screws_test=[25, 30], doors_room_map_size=5, doors_min_obstacles_per_room=0, doors_max_obstacles_per_room=3, doors_min_room_exists_frac=0.25, doors_max_room_exists_frac=0.75, doors_birrt_num_attempts=10, doors_birrt_num_iters=100, doors_birrt_smooth_amt=50, doors_draw_debug=False, doorknobs_target_value=0.75, test_doors_room_map_size=10, narrow_passage_open_door_refine_penalty=0, narrow_passage_door_width_padding_lb=0.0001, narrow_passage_door_width_padding_ub=0.015, narrow_passage_passage_width_padding_lb=0.0005, narrow_passage_passage_width_padding_ub=0.02, narrow_passage_birrt_num_attempts=10, narrow_passage_birrt_num_iters=100, narrow_passage_birrt_smooth_amt=50, exit_garage_clear_refine_penalty=0, exit_garage_min_num_obstacles=2, exit_garage_max_num_obstacles=3, exit_garage_rrt_extend_fn_threshold=0.001, exit_garage_rrt_num_control_samples=100, exit_garage_rrt_num_attempts=3, exit_garage_rrt_num_iters=100, exit_garage_rrt_sample_goal_eps=0.1, exit_garage_motion_planning_ignore_obstacles=False, exit_garage_raise_environment_failure=False, coffee_num_cups_train=[1, 2], coffee_num_cups_test=[2, 3], coffee_jug_init_rot_amt=2.0943951023931953, satellites_num_sat_train=[2, 3], satellites_num_obj_train=[3, 4], satellites_num_sat_test=[3, 4], satellites_num_obj_test=[4, 5], sokoban_gym_name='Sokoban-v0', kitchen_use_perfect_samplers=True, kitchen_goals='boil_kettle', kitchen_render_set_of_marks=True, kitchen_use_combo_move_nsrts=True, kitchen_randomize_init_state=True, sticky_table_num_tables=5, sticky_table_place_smooth_fall_prob=0.6, sticky_table_place_sticky_fall_prob=0.0, sticky_table_pick_success_prob=1.0, sticky_table_tricky_floor_place_sticky_fall_prob=0.5, sticky_table_place_ball_fall_prob=1.0, sticky_table_num_sticky_tables=1, grid_row_num_cells=100, burger_render_set_of_marks=True, burger_no_move_task_type='more_stacks', burger_dummy_render=False, random_options_max_tries=100, option_model_terminate_on_repeat=True, option_model_use_gui=False, gnn_num_message_passing=3, gnn_layer_size=16, gnn_learning_rate=0.001, gnn_weight_decay=0, gnn_num_epochs=25000, gnn_batch_size=128, gnn_do_normalization=False, gnn_use_validation_set=True, gnn_option_policy_solve_with_shooting=True, gnn_option_policy_shooting_variance=0.1, gnn_option_policy_shooting_max_samples=100, metacontroller_max_samples=100, pg3_heuristic='policy_guided', pg3_search_method='hill_climbing', pg3_task_planning_heuristic='lmcut', pg3_gbfs_max_expansions=100, pg3_hc_enforced_depth=0, pg3_max_policy_guided_rollout=50, pg3_plan_compare_inapplicable_cost=0.99, pg3_add_condition_allow_new_vars=True, pg3_max_analogies=5, pg3_init_policy=None, pg3_init_base_env=None, nsrt_rl_reward_epsilon=0.01, nsrt_rl_pos_reward=0, nsrt_rl_neg_reward=-1, nsrt_rl_option_learner='dummy_rl', nsrt_rl_valid_reward_steps_threshold=10, pretrained_model_prompt_cache_dir='pretrained_model_cache', llm_openai_max_response_tokens=700, llm_use_cache_only=False, llm_model_name='text-curie-001', llm_temperature=0.5, llm_num_completions=1, vlm_model_name='gpt-4o', vlm_temperature=0.0, vlm_num_completions=1, vlm_include_cropped_images=False, use_hardcoded_vlm_atom_proposals=False, vlm_double_check_output=True, vlm_open_loop_use_training_demos=False, sesame_task_planner='astar', sesame_task_planning_heuristic='lmcut', sesame_allow_noops=True, sesame_check_expected_atoms=True, sesame_use_necessary_atoms=True, sesame_use_visited_state_set=False, sesame_grounder='naive', sesame_check_static_object_changes=False, sesame_static_object_change_tol=0.001, bilevel_plan_without_sim=True, log_dir='logs', results_dir='results', eval_trajectories_dir='eval_trajectories', approach_dir='saved_approaches', data_dir='saved_datasets', video_dir='videos', image_dir='images', video_fps=2, failure_video_mode='longest_only', offline_data_planning_timeout=-1, offline_data_task_planning_heuristic='default', offline_data_max_skeletons_optimized=-1, offline_data_num_replays=500, offline_data_bilevel_plan_without_sim=None, teacher_dataset_num_examples=1, min_data_for_nsrt=0, min_perc_data_for_nsrt=0, data_orderings_to_search=1, strips_learner='cluster_and_intersect', disable_harmlessness_check=True, enable_harmless_op_pruning=False, precondition_soft_intersection_threshold_percent=0.8, backchaining_check_intermediate_harmlessness=False, pnad_search_without_del=False, pnad_search_timeout=10.0, compute_sidelining_objective_value=False, clustering_learner_true_pos_weight=10, clustering_learner_false_pos_weight=1, cluster_and_intersect_prederror_max_groundings=10, cluster_and_search_inner_search_max_expansions=2500, cluster_and_search_inner_search_timeout=30, cluster_and_search_score_func_max_groundings=10000, cluster_and_search_var_count_weight=0.1, cluster_and_search_precon_size_weight=0.01, cluster_and_intersect_prune_low_data_pnads=True, cluster_and_intersect_min_datastore_fraction=0.05, cluster_and_intersect_soft_intersection_for_preconditions=True, use_torch_gpu=False, learning_rate=0.001, weight_decay=0, mlp_regressor_max_itr=10000, mlp_regressor_hid_sizes=[32, 32], mlp_regressor_clip_gradients=False, mlp_regressor_gradient_clip_value=5, mlp_classifier_hid_sizes=[32, 32], mlp_classifier_balance_data=True, cnn_regressor_max_itr=500, cnn_regressor_conv_channel_nums=[3, 3], cnn_regressor_conv_kernel_sizes=[5, 3], cnn_regressor_linear_hid_sizes=[32, 8], cnn_regressor_clip_gradients=True, cnn_regressor_gradient_clip_value=5, neural_gaus_regressor_hid_sizes=[32, 32], neural_gaus_regressor_max_itr=1000, mlp_classifier_n_iter_no_change=5000, implicit_mlp_regressor_max_itr=10000, implicit_mlp_regressor_num_negative_data_per_input=5, implicit_mlp_regressor_num_samples_per_inference=100, implicit_mlp_regressor_temperature=1.0, implicit_mlp_regressor_inference_method='derivative_free', implicit_mlp_regressor_derivative_free_num_iters=3, implicit_mlp_regressor_derivative_free_sigma_init=0.33, implicit_mlp_regressor_derivative_free_shrink_scale=0.5, implicit_mlp_regressor_grid_num_ticks_per_dim=100, pytorch_train_print_every=1000, sampler_learner='neural', max_rejection_sampling_tries=100, sampler_mlp_classifier_max_itr=10000, sampler_mlp_classifier_n_reinitialize_tries=1, sampler_learning_use_goals=False, sampler_disable_classifier=False, sampler_learning_regressor_model='neural_gaussian', sampler_learning_max_negative_data=100000, option_learning_action_converter='identity', interactive_num_ensemble_members=10, interactive_query_policy='threshold', interactive_score_function='entropy', interactive_score_threshold=0.05, interactive_random_query_prob=0.5, interactive_num_requests_per_cycle=10, predicate_classifier_model='mlp', predicate_mlp_classifier_max_itr=100000, predicate_mlp_classifier_n_reinitialize_tries=1, predicate_mlp_classifier_init='default', predicate_knn_classifier_n_neighbors=1, online_nsrt_learning_requests_per_cycle=10, online_learning_max_novelty_count=0, active_sampler_learning_model='myopic_classifier_mlp', active_sampler_learning_feature_selection='all', active_sampler_learning_knn_neighbors=3, active_sampler_learning_use_teacher=True, active_sampler_learning_num_samples=100, active_sampler_learning_score_gamma=0.5, active_sampler_learning_fitted_q_iters=5, active_sampler_learning_explore_pursue_goal_interval=5, active_sampler_learning_object_specific_samplers=False, active_sampler_learning_n_iter_no_change=5000, active_sampler_learning_num_lookahead_samples=5, active_sampler_learning_explore_length_base=2, active_sampler_learning_num_ensemble_members=10, active_sampler_learning_exploration_sample_strategy='epsilon_greedy', active_sampler_learning_exploration_epsilon=0.5, active_sampler_learning_replay_buffer_size=1000000, active_sampler_learning_batch_size=64, use_epsilon_annealing=True, min_epsilon=0.05, skill_competence_model='optimistic', skill_competence_model_num_em_iters=3, skill_competence_model_max_train_iters=1000, skill_competence_model_learning_rate=0.01, skill_competence_model_lookahead=1, skill_competence_model_optimistic_window_size=5, skill_competence_model_optimistic_recency_size=5, skill_competence_default_alpha_beta=(10.0, 1.0), skill_competence_initial_prediction_bonus=0.5, refinement_estimator='oracle', refinement_estimation_num_skeletons_generated=8, refinement_data_num_skeletons=8, refinement_data_skeleton_generator_timeout=20, refinement_data_low_level_search_timeout=5, refinement_data_failed_refinement_penalty=5, refinement_data_include_execution_cost=True, refinement_data_low_level_execution_cost=0.05, cnn_refinement_estimator_crop=False, cnn_refinement_estimator_crop_bounds=(320, 400, 100, 650), cnn_refinement_estimator_downsample=2, bridge_policy='learned_ldl', glib_min_goal_size=1, glib_max_goal_size=1, glib_num_babbles=10, greedy_lookahead_max_num_trajectories=100, greedy_lookahead_max_traj_length=2, greedy_lookahead_max_num_resamples=10, active_sampler_explore_use_ucb_bonus=True, active_sampler_explore_bonus=0.1, active_sampler_explore_task_strategy='planning_progress', active_sampler_explorer_replan_frequency=100, active_sampler_explorer_planning_progress_max_tasks=10, active_sampler_explorer_planning_progress_max_replan_tasks=5, active_sampler_explorer_skip_perfect=True, active_sampler_learning_init_cycles_to_pursue_goal=1, grammar_search_grammar_includes_givens=False, grammar_search_grammar_includes_foralls=True, grammar_search_grammar_use_diff_features=False, grammar_search_grammar_use_euclidean_dist=False, grammar_search_use_handcoded_debug_grammar=False, grammar_search_forall_penalty=1, grammar_search_pred_selection_approach='score_optimization', grammar_search_pred_clusterer='oracle', grammar_search_true_pos_weight=10, grammar_search_false_pos_weight=1, grammar_search_bf_weight=1, grammar_search_operator_complexity_weight=0.0, grammar_search_pred_complexity_weight=0.0001, grammar_search_max_predicates=100, grammar_search_predicate_cost_upper_bound=13, grammar_search_prune_redundant_preds=True, grammar_search_score_function='expected_nodes_created', grammar_search_heuristic_based_weight=10.0, grammar_search_max_demos=inf, grammar_search_max_nondemos=50, grammar_search_energy_based_temperature=10.0, grammar_search_task_planning_timeout=10.0, grammar_search_search_algorithm='hill_climbing', grammar_search_hill_climbing_depth=0, grammar_search_parallelize_hill_climbing=False, grammar_search_gbfs_num_evals=1000, grammar_search_off_demo_count_penalty=1.0, grammar_search_on_demo_count_penalty=10.0, grammar_search_suspicious_state_penalty=10.0, grammar_search_expected_nodes_upper_bound=100000.0, grammar_search_expected_nodes_optimal_demo_prob=0.99999, grammar_search_expected_nodes_backtracking_cost=1000.0, grammar_search_expected_nodes_allow_noops=True, grammar_search_classifier_pretty_str_names=['?x', '?y', '?z'], grammar_search_vlm_atom_proposal_prompt_type='options_labels_whole_traj_specific', grammar_search_vlm_atom_label_prompt_type='img_option_diffs_label_history', grammar_search_vlm_atom_proposal_use_debug=False, grammar_search_parallelize_vlm_labeling=True, grammar_search_select_all_debug=False, grammar_search_invent_geo_predicates_only=True, grammar_search_early_termination_heuristic_thresh=100, grammar_search_clustering_gmm_num_components=10, handmade_demo_filename='', vlm_trajs_folder_name='', vlm_predicate_vision_api_generate_ground_atoms=False, vlm_test_time_atom_label_prompt_type='per_scene_naive', save_eval_trajs=False, get_arg_specific_settings=<classmethod(<function GlobalSettings.get_arg_specific_settings at 0x7fc5cd56eef0>)>, perceiver='kitchen', horizon=1000, max_num_steps_option_rollout=1000, sesame_propagate_failures='immediately', offline_data_method='geo_and_demo_with_vlm_imgs', option_model_name='oracle', sesame_max_skeletons_optimized=200, sesame_max_samples_per_step=10, grammar_search_expected_nodes_max_skeletons=-1, grammar_search_diff_features_const_multiplier=1e-06, grammar_search_euclidean_feature_names=[('x', 'y', 'x', 'y')], grammar_search_euclidean_const_multiplier=1e-06, cover_num_blocks=2, cover_num_targets=2, cover_block_widths=[0.1, 0.07], cover_target_widths=[0.05, 0.03], cover_initial_holding_prob=0.75, env='kitchen', approach='grammar_search_invention', excluded_predicates='all', included_options='', seed=2, option_learner='no_learning', explorer='no_explore', execution_monitor='trivial', timeout=10, make_test_videos=False, make_failure_videos=False, make_interaction_videos=False, make_demo_videos=False, make_demo_images=False, make_cogman_videos=False, load_approach=False, restart_learning=False, load_data=False, load_atoms=False, save_atoms=False, skip_until_cycle=-1, experiment_id='kitchen_boil_kettle-ours-vlm-subselection', load_experiment_id='', log_file='', use_gui=False, loglevel=20, crash_on_failure=False)
Git commit hash: 5f61ec103eb25f1d60acd3d490786eda706a607f
All non-goal predicates excluded: {'AtPrePushOnTop', 'TurnedOff', 'Closed', 'AtPreTurnOff', 'BurnerBehind', 'Open', 'AtPrePullKettle', 'NotOnTop', 'AtPreTurnOn', 'OnTop', 'BurnerAhead', 'TurnedOn'}
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.set_body_position to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.set_body_position` for environment variables or `env.get_wrapper_attr('set_body_position')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.model to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.model` for environment variables or `env.get_wrapper_attr('model')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.data to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.data` for environment variables or `env.get_wrapper_attr('data')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gymnasium/core.py:311: UserWarning: [33mWARN: env.robot_env to get variables from other wrappers is deprecated and will be removed in v1.0, to get this variable you can do `env.unwrapped.robot_env` for environment variables or `env.get_wrapper_attr('robot_env')` that will search the reminding wrappers.[0m
  logger.warn(
/home/njk/miniconda3/envs/predicators_vlm/lib/python3.10/site-packages/gym/spaces/box.py:127: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  logger.warn(f"Box bound precision lowered by casting to {self.dtype}")
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.
[CogMan] Reset called.
[CogMan] Finishing episode.


CREATED 3 DEMONSTRATIONS
Querying VLM for candidate atom proposals...
Completed (1/3) init atoms queries to the VLM.
Completed (2/3) init atoms queries to the VLM.
Completed (3/3) init atoms queries to the VLM.
Done querying VLM for candidate atoms!
VISUAL PREDICATES PROPOSED
holding
off
connected
not_on
gripper_free
on
not_holding
kettle_empty
VLM proposed a total of 31 atoms.
Of these, 19 were valid and unique.
For the 8 predicates, there were 51 unique groundings.
END VISUAL PREDICATES PROPOSALS
Querying VLM to label every scene...
Labeling trajectories in parallel.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (1/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #3 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #3 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #1 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (2/3) label queries to VLM for trajectory #2 of 3!
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #1 of 3!
Finished labeling trajectory.
HTTP Request: POST https://api.openai.com/v1/chat/completions "HTTP/1.1 200 OK"
Completed (3/3) label queries to VLM for trajectory #2 of 3!
Finished labeling trajectory.
Done querying VLM for scene labelling!
Human-readable labelled trajectory saved to saved_datasets/kitchen__demo+labelled_atoms__manual__3.txt!
Generating candidate predicates...
Done: created 100 candidates:
((0:gripper).x<=[idx 0]-0.151) 2.0
Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).x<=[idx 0]-0.151)(0)] 3.0
NOT-((0:gripper).x<=[idx 0]-0.151) 2.0
((0:gripper).z<=[idx 0]2.17) 2.0
Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 0]2.17)(0)] 3.0
NOT-((0:gripper).z<=[idx 0]2.17) 2.0
((0:gripper).qw<=[idx 0]0.271) 2.0
Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 0]0.271)(0)] 3.0
NOT-((0:gripper).qw<=[idx 0]0.271) 2.0
((0:hinge_door).x<=[idx 0]-0.395) 2.0
Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-Forall[0:hinge_door].[((0:hinge_door).x<=[idx 0]-0.395)(0)] 3.0
NOT-((0:hinge_door).x<=[idx 0]-0.395) 2.0
((0:hinge_door).y<=[idx 0]0.55) 2.0
NOT-((0:hinge_door).y<=[idx 0]0.55) 2.0
((0:kettle).x<=[idx 0]-0.263) 2.0
NOT-((0:kettle).x<=[idx 0]-0.263) 2.0
((0:kettle).z<=[idx 0]1.88) 2.0
Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 0]1.88)(0)] 3.0
NOT-((0:kettle).z<=[idx 0]1.88) 2.0
((0:knob).x<=[idx 0]-0.195) 2.0
NOT-((0:knob).x<=[idx 0]-0.195) 2.0
((0:knob).z<=[idx 0]2.28) 2.0
NOT-((0:knob).z<=[idx 0]2.28) 2.0
((0:knob).angle<=[idx 0]-0.76) 2.0
NOT-((0:knob).angle<=[idx 0]-0.76) 2.0
Forall[0:knob].[NOT-((0:knob).angle<=[idx 0]-0.76)(0)] 3.0
NOT-Forall[0:knob].[NOT-((0:knob).angle<=[idx 0]-0.76)(0)] 3.0
((0:surface).x<=[idx 0]-0.002) 2.0
NOT-((0:surface).x<=[idx 0]-0.002) 2.0
((0:surface).y<=[idx 0]0.559) 2.0
NOT-((0:surface).y<=[idx 0]0.559) 2.0
((0:surface).z<=[idx 0]1.6) 2.0
NOT-((0:surface).z<=[idx 0]1.6) 2.0
((0:gripper).y<=[idx 1]0.543) 3.0
Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 1]0.543)(0)] 4.0
NOT-((0:gripper).y<=[idx 1]0.543) 3.0
((0:hinge_door).x<=[idx 1]-0.538) 3.0
NOT-((0:hinge_door).x<=[idx 1]-0.538) 3.0
((0:kettle).y<=[idx 1]0.479) 3.0
Forall[0:kettle].[((0:kettle).y<=[idx 1]0.479)(0)] 4.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 1]0.479)(0)] 4.0
NOT-((0:kettle).y<=[idx 1]0.479) 3.0
((0:surface).z<=[idx 1]1.6) 3.0
NOT-((0:surface).z<=[idx 1]1.6) 3.0
((0:knob).angle<=[idx 2]-0.38) 3.0
NOT-((0:knob).angle<=[idx 2]-0.38) 3.0
((0:gripper).y<=[idx 3]0.541) 4.0
Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-Forall[0:gripper].[((0:gripper).y<=[idx 3]0.541)(0)] 5.0
NOT-((0:gripper).y<=[idx 3]0.541) 4.0
((0:knob).angle<=[idx 4]-0.57) 4.0
NOT-((0:knob).angle<=[idx 4]-0.57) 4.0
((0:surface).z<=[idx 5]1.6) 4.0
NOT-((0:surface).z<=[idx 5]1.6) 4.0
((0:kettle).z<=[idx 6]1.88) 4.0
Forall[0:kettle].[((0:kettle).z<=[idx 6]1.88)(0)] 5.0
NOT-Forall[0:kettle].[((0:kettle).z<=[idx 6]1.88)(0)] 5.0
NOT-((0:kettle).z<=[idx 6]1.88) 4.0
((0:hinge_door).x<=[idx 7]-0.646) 5.0
NOT-((0:hinge_door).x<=[idx 7]-0.646) 5.0
((0:kettle).y<=[idx 7]0.448) 5.0
Forall[0:kettle].[((0:kettle).y<=[idx 7]0.448)(0)] 6.0
NOT-Forall[0:kettle].[((0:kettle).y<=[idx 7]0.448)(0)] 6.0
NOT-((0:kettle).y<=[idx 7]0.448) 5.0
((0:surface).z<=[idx 9]1.6) 5.0
NOT-((0:surface).z<=[idx 9]1.6) 5.0
((0:knob).angle<=[idx 12]-0.475) 5.0
NOT-((0:knob).angle<=[idx 12]-0.475) 5.0
((0:kettle).x<=[idx 14]-0.257) 5.0
Forall[0:kettle].[((0:kettle).x<=[idx 14]-0.257)(0)] 6.0
NOT-Forall[0:kettle].[((0:kettle).x<=[idx 14]-0.257)(0)] 6.0
NOT-((0:kettle).x<=[idx 14]-0.257) 5.0
((0:knob).angle<=[idx 20]-0.522) 6.0
NOT-((0:knob).angle<=[idx 20]-0.522) 6.0
((0:surface).z<=[idx 25]1.6) 6.0
NOT-((0:surface).z<=[idx 25]1.6) 6.0
((0:gripper).qw<=[idx 43]0.111) 7.0
Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 43]0.111)(0)] 8.0
NOT-((0:gripper).qw<=[idx 43]0.111) 7.0
((0:gripper).z<=[idx 63]1.92) 8.0
NOT-((0:gripper).z<=[idx 63]1.92) 8.0
((0:gripper).qw<=[idx 75]0.107) 8.0
Forall[0:gripper].[((0:gripper).qw<=[idx 75]0.107)(0)] 9.0
NOT-Forall[0:gripper].[((0:gripper).qw<=[idx 75]0.107)(0)] 9.0
NOT-((0:gripper).qw<=[idx 75]0.107) 8.0
((0:gripper).z<=[idx 127]1.92) 9.0
Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-Forall[0:gripper].[((0:gripper).z<=[idx 127]1.92)(0)] 10.0
NOT-((0:gripper).z<=[idx 127]1.92) 9.0
((0:gripper).qx<=[idx 127]-0.713) 9.0
NOT-((0:gripper).qx<=[idx 127]-0.713) 9.0
((0:surface).x<=[idx 127]-0.223) 9.0
NOT-((0:surface).x<=[idx 127]-0.223) 9.0
Applying predicates to data...
Done.
Selecting a subset...
Evaluating predicates: frozenset(), with total cost 0
	Total score: 3276.9688603114005 computed in 37.515 seconds


Starting hill climbing at state frozenset() with heuristic 3276.9688603114005
Searching for an improvement at depth 0
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 3146.9702003044 computed in 42.085 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 3146.9707003043995 computed in 40.617 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].qw<=[idx_75]0.107][0]]}), with total cost 9.0
	Total score: 3146.9708003043997 computed in 40.462 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 201.03048000319993 computed in 39.128 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 201.03058000319993 computed in 39.966 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 201.0306800031999 computed in 40.325 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 37.702 seconds
Evaluating predicates: frozenset({Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3276.9698603114007 computed in 37.411 seconds
Evaluating predicates: frozenset({Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 38.906 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].x<=[idx_14]-0.257][0]]}), with total cost 6.0
	Total score: 3306.9689003169997 computed in 39.968 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.479][0]]}), with total cost 4.0
	Total score: 2196.9791308336044 computed in 38.917 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].y<=[idx_7]0.448][0]]}), with total cost 6.0
	Total score: 3179.970310307099 computed in 38.268 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3280.9686603184005 computed in 39.127 seconds
Evaluating predicates: frozenset({Forall[0:kettle].[[[0:kettle].z<=[idx_6]1.88][0]]}), with total cost 5.0
	Total score: 3276.9691003146004 computed in 40.824 seconds
Evaluating predicates: frozenset({Forall[0:knob].[NOT-[[0:knob].angle<=[idx_0]-0.76][0]]}), with total cost 3.0
	Total score: 3276.9687003174004 computed in 38.826 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_0]0.271][0]]}), with total cost 3.0
	Total score: 201.03048000319993 computed in 39.773 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_43]0.111][0]]}), with total cost 8.0
	Total score: 201.03098000319991 computed in 40.261 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].qw<=[idx_75]0.107][0]]}), with total cost 9.0
	Total score: 201.03108000319992 computed in 39.357 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].x<=[idx_0]-0.151][0]]}), with total cost 3.0
	Total score: 3146.9702003044 computed in 41.344 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_1]0.543][0]]}), with total cost 4.0
	Total score: 3146.9703003043996 computed in 42.301 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].y<=[idx_3]0.541][0]]}), with total cost 5.0
	Total score: 3146.9704003044 computed in 40.973 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_0]2.17][0]]}), with total cost 3.0
	Total score: 3254.969060313 computed in 39.677 seconds
Evaluating predicates: frozenset({NOT-Forall[0:gripper].[[[0:gripper].z<=[idx_127]1.92][0]]}), with total cost 10.0
	Total score: 3308.9691603190004 computed in 39.822 seconds
Evaluating predicates: frozenset({NOT-Forall[0:hinge_door].[[[0:hinge_door].x<=[idx_0]-0.395][0]]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 39.301 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].x<=[idx_14]-0.257][0]]}), with total cost 6.0
	Total score: 3276.9694603114003 computed in 37.999 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_1]0.479][0]]}), with total cost 4.0
	Total score: 3204.9697303087996 computed in 37.582 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].y<=[idx_7]0.448][0]]}), with total cost 6.0
	Total score: 2208.989720210899 computed in 39.928 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_0]1.88][0]]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 38.116 seconds
Evaluating predicates: frozenset({NOT-Forall[0:kettle].[[[0:kettle].z<=[idx_6]1.88][0]]}), with total cost 5.0
	Total score: 3276.9693603114006 computed in 38.770 seconds
Evaluating predicates: frozenset({NOT-Forall[0:knob].[NOT-[[0:knob].angle<=[idx_0]-0.76][0]]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 38.684 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 201.03038000319992 computed in 40.206 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 201.0308800031999 computed in 40.360 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qw<=[idx_75]0.107]}), with total cost 8.0
	Total score: 201.03098000319991 computed in 39.645 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].qx<=[idx_127]-0.713]}), with total cost 9.0
	Total score: 3280.9692603184003 computed in 39.566 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].x<=[idx_0]-0.151]}), with total cost 2.0
	Total score: 3146.9701003043997 computed in 41.948 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_1]0.543]}), with total cost 3.0
	Total score: 3146.9702003044 computed in 41.521 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].y<=[idx_3]0.541]}), with total cost 4.0
	Total score: 3146.9703003043996 computed in 43.979 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_0]2.17]}), with total cost 2.0
	Total score: 3254.968960313 computed in 39.646 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_127]1.92]}), with total cost 9.0
	Total score: 3308.969060319 computed in 40.061 seconds
Evaluating predicates: frozenset({NOT-[[0:gripper].z<=[idx_63]1.92]}), with total cost 8.0
	Total score: 3276.9692003174 computed in 40.970 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_0]-0.395]}), with total cost 2.0
	Total score: 3276.9690603114004 computed in 38.391 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_1]-0.538]}), with total cost 3.0
	Total score: 3276.9691603114006 computed in 38.243 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].x<=[idx_7]-0.646]}), with total cost 5.0
	Total score: 3276.9693603114006 computed in 37.775 seconds
Evaluating predicates: frozenset({NOT-[[0:hinge_door].y<=[idx_0]0.55]}), with total cost 2.0
	Total score: 3276.9690603114004 computed in 39.245 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_0]-0.263]}), with total cost 2.0
	Total score: 3276.9690603114004 computed in 38.101 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].x<=[idx_14]-0.257]}), with total cost 5.0
	Total score: 3276.9693603114006 computed in 39.412 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_1]0.479]}), with total cost 3.0
	Total score: 3204.9696303088 computed in 38.272 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].y<=[idx_7]0.448]}), with total cost 5.0
	Total score: 2224.9896902104992 computed in 39.258 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_0]1.88]}), with total cost 2.0
	Total score: 3276.9690603114004 computed in 37.809 seconds
Evaluating predicates: frozenset({NOT-[[0:kettle].z<=[idx_6]1.88]}), with total cost 4.0
	Total score: 3276.9692603114004 computed in 38.340 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_0]-0.76]}), with total cost 2.0
	Total score: 3222.968190333401 computed in 46.340 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_12]-0.475]}), with total cost 5.0
	Total score: 3216.9684403436 computed in 46.083 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_20]-0.522]}), with total cost 6.0
	Total score: 3216.9685403435997 computed in 44.605 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_2]-0.38]}), with total cost 3.0
	Total score: 3268.96619039 computed in 46.858 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].angle<=[idx_4]-0.57]}), with total cost 4.0
	Total score: 3216.9686103348 computed in 45.557 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].x<=[idx_0]-0.195]}), with total cost 2.0
	Total score: 3096.9704303029 computed in 42.530 seconds
Evaluating predicates: frozenset({NOT-[[0:knob].z<=[idx_0]2.28]}), with total cost 2.0
	Total score: 3102.969920304999 computed in 42.269 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_0]-0.002]}), with total cost 2.0
	Total score: 3096.9704303029 computed in 41.660 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].x<=[idx_127]-0.223]}), with total cost 9.0
	Total score: 3100.9706103073 computed in 44.100 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].y<=[idx_0]0.559]}), with total cost 2.0
	Total score: 3102.969920304999 computed in 42.567 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_0]1.6]}), with total cost 2.0
	Total score: 3292.9647204301987 computed in 38.380 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_1]1.6]}), with total cost 3.0
	Total score: 147.03033999999988 computed in 40.431 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_25]1.6]}), with total cost 6.0
	Total score: 3334.9631804915975 computed in 38.751 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_5]1.6]}), with total cost 4.0
	Total score: 3334.9629804915976 computed in 42.144 seconds
Evaluating predicates: frozenset({NOT-[[0:surface].z<=[idx_9]1.6]}), with total cost 5.0
	Total score: 3334.963080491598 computed in 41.936 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_0]0.271]}), with total cost 2.0
	Total score: 3146.9701003043997 computed in 46.608 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_43]0.111]}), with total cost 7.0
	Total score: 3146.9706003044 computed in 44.953 seconds
Evaluating predicates: frozenset({[[0:gripper].qw<=[idx_75]0.107]}), with total cost 8.0
